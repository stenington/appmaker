(function(global,document){if(!document.addEventListener){global.Popcorn={isSupported:false};var methods=("byId forEach extend effects error guid sizeOf isArray nop position disable enable destroy"+"addTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId "+"timeUpdate plugin removePlugin compose effect xhr getJSONP getScript").split(/\s+/);while(methods.length){global.Popcorn[methods.shift()]=function(){}}return}var AP=Array.prototype,OP=Object.prototype,forEach=AP.forEach,slice=AP.slice,hasOwn=OP.hasOwnProperty,toString=OP.toString,_Popcorn=global.Popcorn,readyStack=[],readyBound=false,readyFired=false,internal={events:{hash:{},apis:{}}},requestAnimFrame=function(){return global.requestAnimationFrame||global.webkitRequestAnimationFrame||global.mozRequestAnimationFrame||global.oRequestAnimationFrame||global.msRequestAnimationFrame||function(callback,element){global.setTimeout(callback,16)}}(),getKeys=function(obj){return Object.keys?Object.keys(obj):function(obj){var item,list=[];for(item in obj){if(hasOwn.call(obj,item)){list.push(item)}}return list}(obj)},Abstract={put:function(dictionary){for(var key in dictionary){if(dictionary.hasOwnProperty(key)){this[key]=dictionary[key]}}}},Popcorn=function(entity,options){return new Popcorn.p.init(entity,options||null)};Popcorn.version="@VERSION";Popcorn.isSupported=true;Popcorn.instances=[];Popcorn.p=Popcorn.prototype={init:function(entity,options){var matches,nodeName,self=this;if(typeof entity==="function"){if(document.readyState==="complete"){entity(document,Popcorn);return}readyStack.push(entity);if(!readyBound){readyBound=true;var DOMContentLoaded=function(){readyFired=true;document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);for(var i=0,readyStackLength=readyStack.length;i<readyStackLength;i++){readyStack[i].call(document,Popcorn)}readyStack=null};document.addEventListener("DOMContentLoaded",DOMContentLoaded,false)}return}if(typeof entity==="string"){try{matches=document.querySelector(entity)}catch(e){throw new Error("Popcorn.js Error: Invalid media element selector: "+entity)}}this.media=matches||entity;nodeName=this.media.nodeName&&this.media.nodeName.toLowerCase()||"video";this[nodeName]=this.media;this.options=Popcorn.extend({},options)||{};this.id=this.options.id||Popcorn.guid(nodeName);if(Popcorn.byId(this.id)){throw new Error("Popcorn.js Error: Cannot use duplicate ID ("+this.id+")")}this.isDestroyed=false;this.data={running:{cue:[]},timeUpdate:Popcorn.nop,disabled:{},events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:new TrackEvents(this)};Popcorn.instances.push(this);var isReady=function(){if(self.media.currentTime<0){self.media.currentTime=0}self.media.removeEventListener("loadedmetadata",isReady,false);var duration,videoDurationPlus,runningPlugins,runningPlugin,rpLength,rpNatives;duration=self.media.duration;videoDurationPlus=duration!=duration?Number.MAX_VALUE:duration+1;Popcorn.addTrackEvent(self,{start:videoDurationPlus,end:videoDurationPlus});if(!self.isDestroyed){self.data.durationChange=function(){var newDuration=self.media.duration,newDurationPlus=newDuration+1,byStart=self.data.trackEvents.byStart,byEnd=self.data.trackEvents.byEnd;byStart.pop();byEnd.pop();for(var k=byEnd.length-1;k>0;k--){if(byEnd[k].end>newDuration){self.removeTrackEvent(byEnd[k]._id)}}for(var i=0;i<byStart.length;i++){if(byStart[i].end>newDuration){self.removeTrackEvent(byStart[i]._id)}}self.data.trackEvents.byEnd.push({start:newDurationPlus,end:newDurationPlus});self.data.trackEvents.byStart.push({start:newDurationPlus,end:newDurationPlus})};self.media.addEventListener("durationchange",self.data.durationChange,false)}if(self.options.frameAnimation){self.data.timeUpdate=function(){Popcorn.timeUpdate(self,{});Popcorn.forEach(Popcorn.manifest,function(key,val){runningPlugins=self.data.running[val];if(runningPlugins){rpLength=runningPlugins.length;for(var i=0;i<rpLength;i++){runningPlugin=runningPlugins[i];rpNatives=runningPlugin._natives;rpNatives&&rpNatives.frame&&rpNatives.frame.call(self,{},runningPlugin,self.currentTime())}}});self.emit("timeupdate");!self.isDestroyed&&requestAnimFrame(self.data.timeUpdate)};!self.isDestroyed&&requestAnimFrame(self.data.timeUpdate)}else{self.data.timeUpdate=function(event){Popcorn.timeUpdate(self,event)};if(!self.isDestroyed){self.media.addEventListener("timeupdate",self.data.timeUpdate,false)}}};self.media.addEventListener("error",function(){self.error=self.media.error},false);if(self.media.readyState>=1){isReady()}else{self.media.addEventListener("loadedmetadata",isReady,false)}return this}};Popcorn.p.init.prototype=Popcorn.p;Popcorn.byId=function(str){var instances=Popcorn.instances,length=instances.length,i=0;for(;i<length;i++){if(instances[i].id===str){return instances[i]}}return null};Popcorn.forEach=function(obj,fn,context){if(!obj||!fn){return{}}context=context||this;var key,len;if(forEach&&obj.forEach===forEach){return obj.forEach(fn,context)}if(toString.call(obj)==="[object NodeList]"){for(key=0,len=obj.length;key<len;key++){fn.call(context,obj[key],key,obj)}return obj}for(key in obj){if(hasOwn.call(obj,key)){fn.call(context,obj[key],key,obj)}}return obj};Popcorn.extend=function(obj){var dest=obj,src=slice.call(arguments,1);Popcorn.forEach(src,function(copy){for(var prop in copy){dest[prop]=copy[prop]}});return dest};Popcorn.extend(Popcorn,{noConflict:function(deep){if(deep){global.Popcorn=_Popcorn}return Popcorn},error:function(msg){throw new Error(msg)},guid:function(prefix){Popcorn.guid.counter++;return(prefix?prefix:"")+(+new Date+Popcorn.guid.counter)},sizeOf:function(obj){var size=0;for(var prop in obj){size++}return size},isArray:Array.isArray||function(array){return toString.call(array)==="[object Array]"},nop:function(){},position:function(elem){if(!elem.parentNode){return null}var clientRect=elem.getBoundingClientRect(),bounds={},doc=elem.ownerDocument,docElem=document.documentElement,body=document.body,clientTop,clientLeft,scrollTop,scrollLeft,top,left;clientTop=docElem.clientTop||body.clientTop||0;clientLeft=docElem.clientLeft||body.clientLeft||0;scrollTop=global.pageYOffset&&docElem.scrollTop||body.scrollTop;scrollLeft=global.pageXOffset&&docElem.scrollLeft||body.scrollLeft;top=Math.ceil(clientRect.top+scrollTop-clientTop);left=Math.ceil(clientRect.left+scrollLeft-clientLeft);for(var p in clientRect){bounds[p]=Math.round(clientRect[p])}return Popcorn.extend({},bounds,{top:top,left:left})},disable:function(instance,plugin){if(instance.data.disabled[plugin]){return}instance.data.disabled[plugin]=true;if(plugin in Popcorn.registryByName&&instance.data.running[plugin]){for(var i=instance.data.running[plugin].length-1,event;i>=0;i--){event=instance.data.running[plugin][i];event._natives.end.call(instance,null,event);instance.emit("trackend",Popcorn.extend({},event,{plugin:event.type,type:"trackend"}))}}return instance},enable:function(instance,plugin){if(!instance.data.disabled[plugin]){return}instance.data.disabled[plugin]=false;if(plugin in Popcorn.registryByName&&instance.data.running[plugin]){for(var i=instance.data.running[plugin].length-1,event;i>=0;i--){event=instance.data.running[plugin][i];event._natives.start.call(instance,null,event);instance.emit("trackstart",Popcorn.extend({},event,{plugin:event.type,type:"trackstart",track:event}))}}return instance},destroy:function(instance){var events=instance.data.events,trackEvents=instance.data.trackEvents,singleEvent,item,fn,plugin;for(item in events){singleEvent=events[item];for(fn in singleEvent){delete singleEvent[fn]}events[item]=null}for(plugin in Popcorn.registryByName){Popcorn.removePlugin(instance,plugin)}trackEvents.byStart.length=0;trackEvents.byEnd.length=0;if(!instance.isDestroyed){instance.data.timeUpdate&&instance.media.removeEventListener("timeupdate",instance.data.timeUpdate,false);instance.isDestroyed=true}Popcorn.instances.splice(Popcorn.instances.indexOf(instance),1)}});Popcorn.guid.counter=1;Popcorn.extend(Popcorn.p,function(){var methods="load play pause currentTime playbackRate volume duration preload playbackRate "+"autoplay loop controls muted buffered readyState seeking paused played seekable ended",ret={};Popcorn.forEach(methods.split(/\s+/g),function(name){ret[name]=function(arg){var previous;if(typeof this.media[name]==="function"){if(arg!=null&&/play|pause/.test(name)){this.media.currentTime=Popcorn.util.toSeconds(arg)}this.media[name]();return this}if(arg!=null){previous=this.media[name];this.media[name]=arg;if(previous!==arg){this.emit("attrchange",{attribute:name,previousValue:previous,currentValue:arg})}return this}return this.media[name]}});return ret}());Popcorn.forEach("enable disable".split(" "),function(method){Popcorn.p[method]=function(plugin){return Popcorn[method](this,plugin)}});Popcorn.extend(Popcorn.p,{roundTime:function(){return Math.round(this.media.currentTime)},exec:function(id,time,fn){var length=arguments.length,eventType="trackadded",trackEvent,sec,options;try{sec=Popcorn.util.toSeconds(id)}catch(e){}if(typeof sec==="number"){id=sec}if(typeof id==="number"&&length===2){fn=time;time=id;id=Popcorn.guid("cue")}else{if(length===1){time=-1}else{trackEvent=this.getTrackEvent(id);if(trackEvent){this.data.trackEvents.remove(id);TrackEvent.end(this,trackEvent);Popcorn.removeTrackEvent.ref(this,id);eventType="cuechange";if(typeof id==="string"&&length===2){if(typeof time==="number"){fn=trackEvent._natives.start}if(typeof time==="function"){fn=time;time=trackEvent.start}}}else{if(length>=2){if(typeof time==="string"){try{sec=Popcorn.util.toSeconds(time)}catch(e){}time=sec}if(typeof time==="number"){fn=fn||Popcorn.nop()}if(typeof time==="function"){fn=time;time=-1}}}}}options={id:id,start:time,end:time+1,_running:false,_natives:{start:fn||Popcorn.nop,end:Popcorn.nop,type:"cue"}};if(trackEvent){options=Popcorn.extend(trackEvent,options)}if(eventType==="cuechange"){options._id=options.id||options._id||Popcorn.guid(options._natives.type);this.data.trackEvents.add(options);TrackEvent.start(this,options);this.timeUpdate(this,null,true);Popcorn.addTrackEvent.ref(this,options);this.emit(eventType,Popcorn.extend({},options,{id:id,type:eventType,previousValue:{time:trackEvent.start,fn:trackEvent._natives.start},currentValue:{time:time,fn:fn||Popcorn.nop},track:trackEvent}))}else{Popcorn.addTrackEvent(this,options)}return this},mute:function(toggle){var event=toggle==null||toggle===true?"muted":"unmuted";if(event==="unmuted"){this.media.muted=false;this.media.volume=this.data.state.volume}if(event==="muted"){this.data.state.volume=this.media.volume;this.media.muted=true}this.emit(event);return this},unmute:function(toggle){return this.mute(toggle==null?false:!toggle)},position:function(){return Popcorn.position(this.media)},toggle:function(plugin){return Popcorn[this.data.disabled[plugin]?"enable":"disable"](this,plugin)},defaults:function(plugin,defaults){if(Popcorn.isArray(plugin)){Popcorn.forEach(plugin,function(obj){for(var name in obj){this.defaults(name,obj[name])}},this);return this}if(!this.options.defaults){this.options.defaults={}}if(!this.options.defaults[plugin]){this.options.defaults[plugin]={}}Popcorn.extend(this.options.defaults[plugin],defaults);return this}});Popcorn.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause error "+"loadedmetadata loadeddata waiting playing canplay canplaythrough "+"seeking seeked timeupdate ended ratechange durationchange volumechange"};Popcorn.Events.Natives=Popcorn.Events.UIEvents+" "+Popcorn.Events.MouseEvents+" "+Popcorn.Events.Events;internal.events.apiTypes=["UIEvents","MouseEvents","Events"];(function(events,data){var apis=internal.events.apiTypes,eventsList=events.Natives.split(/\s+/g),idx=0,len=eventsList.length,prop;for(;idx<len;idx++){data.hash[eventsList[idx]]=true}apis.forEach(function(val,idx){data.apis[val]={};var apiEvents=events[val].split(/\s+/g),len=apiEvents.length,k=0;for(;k<len;k++){data.apis[val][apiEvents[k]]=true}})})(Popcorn.Events,internal.events);Popcorn.events={isNative:function(type){return!!internal.events.hash[type]},getInterface:function(type){if(!Popcorn.events.isNative(type)){return false}var eventApi=internal.events,apis=eventApi.apiTypes,apihash=eventApi.apis,idx=0,len=apis.length,api,tmp;for(;idx<len;idx++){tmp=apis[idx];if(apihash[tmp][type]){api=tmp;break}}return api},all:Popcorn.Events.Natives.split(/\s+/g),fn:{trigger:function(type,data){var eventInterface,evt,clonedEvents,events=this.data.events[type];if(events){eventInterface=Popcorn.events.getInterface(type);if(eventInterface){evt=document.createEvent(eventInterface);evt.initEvent(type,true,true,global,1);this.media.dispatchEvent(evt);return this}clonedEvents=events.slice();while(clonedEvents.length){clonedEvents.shift().call(this,data)}}return this},listen:function(type,fn){var self=this,hasEvents=true,eventHook=Popcorn.events.hooks[type],origType=type,clonedEvents,tmp;if(typeof fn!=="function"){throw new Error("Popcorn.js Error: Listener is not a function")}if(!this.data.events[type]){this.data.events[type]=[];hasEvents=false}if(eventHook){if(eventHook.add){eventHook.add.call(this,{},fn)}if(eventHook.bind){type=eventHook.bind}if(eventHook.handler){tmp=fn;fn=function wrapper(event){eventHook.handler.call(self,event,tmp)}}hasEvents=true;if(!this.data.events[type]){this.data.events[type]=[];hasEvents=false}}this.data.events[type].push(fn);if(!hasEvents&&Popcorn.events.all.indexOf(type)>-1){this.media.addEventListener(type,function(event){if(self.data.events[type]){clonedEvents=self.data.events[type].slice();while(clonedEvents.length){clonedEvents.shift().call(self,event)}}},false)}return this},unlisten:function(type,fn){var ind,events=this.data.events[type];if(!events){return}if(typeof fn==="string"){for(var i=0;i<events.length;i++){if(events[i].name===fn){events.splice(i--,1)}}return this}else if(typeof fn==="function"){while(ind!==-1){ind=events.indexOf(fn);if(ind!==-1){events.splice(ind,1)}}return this}this.data.events[type]=null;return this}},hooks:{canplayall:{bind:"canplaythrough",add:function(event,callback){var state=false;if(this.media.readyState){setTimeout(function(){callback.call(this,event)}.bind(this),0);state=true}this.data.hooks.canplayall={fired:state}},handler:function canplayall(event,callback){if(!this.data.hooks.canplayall.fired){callback.call(this,event);this.data.hooks.canplayall.fired=true}}}}};Popcorn.forEach([["trigger","emit"],["listen","on"],["unlisten","off"]],function(key){Popcorn.p[key[0]]=Popcorn.p[key[1]]=Popcorn.events.fn[key[0]]});function TrackEvent(track){Abstract.put.call(this,track)}TrackEvent.start=function(instance,track){if(track.end>instance.media.currentTime&&track.start<=instance.media.currentTime&&!track._running){track._running=true;instance.data.running[track._natives.type].push(track);if(!instance.data.disabled[track._natives.type]){track._natives.start.call(instance,null,track);instance.emit("trackstart",Popcorn.extend({},track,{plugin:track._natives.type,type:"trackstart",track:track}))}}};TrackEvent.end=function(instance,track){var runningPlugins;if((track.end<=instance.media.currentTime||track.start>instance.media.currentTime)&&track._running){runningPlugins=instance.data.running[track._natives.type];track._running=false;runningPlugins.splice(runningPlugins.indexOf(track),1);if(!instance.data.disabled[track._natives.type]){track._natives.end.call(instance,null,track);instance.emit("trackend",Popcorn.extend({},track,{plugin:track._natives.type,type:"trackend",track:track}))}}};function TrackEvents(parent){this.parent=parent;this.byStart=[{start:-1,end:-1}];this.byEnd=[{start:-1,end:-1}];this.animating=[];this.startIndex=0;this.endIndex=0;this.previousUpdateTime=-1;this.count=1}function isMatch(obj,key,value){return obj[key]&&obj[key]===value}TrackEvents.prototype.where=function(params){return(this.parent.getTrackEvents()||[]).filter(function(event){var key,value;if(!params){return true}for(key in params){value=params[key];if(isMatch(event,key,value)||isMatch(event._natives,key,value)){return true}}return false})};TrackEvents.prototype.add=function(track){var byStart=this.byStart,byEnd=this.byEnd,startIndex,endIndex;if(track&&track._id){this.parent.data.history.push(track._id)}track.start=Popcorn.util.toSeconds(track.start,this.parent.options.framerate);track.end=Popcorn.util.toSeconds(track.end,this.parent.options.framerate);for(startIndex=byStart.length-1;startIndex>=0;startIndex--){if(track.start>=byStart[startIndex].start){byStart.splice(startIndex+1,0,track);break}}for(endIndex=byEnd.length-1;endIndex>=0;endIndex--){if(track.end>byEnd[endIndex].end){byEnd.splice(endIndex+1,0,track);break}}if(startIndex<=this.parent.data.trackEvents.startIndex&&track.start<=this.parent.data.trackEvents.previousUpdateTime){this.parent.data.trackEvents.startIndex++}if(endIndex<=this.parent.data.trackEvents.endIndex&&track.end<this.parent.data.trackEvents.previousUpdateTime){this.parent.data.trackEvents.endIndex++}this.count++};TrackEvents.prototype.remove=function(removeId,state){if(removeId instanceof TrackEvent){removeId=removeId.id}if(typeof removeId==="object"){this.where(removeId).forEach(function(event){this.removeTrackEvent(event._id)},this.parent);return this}var start,end,animate,historyLen,track,length=this.byStart.length,index=0,indexWasAt=0,byStart=[],byEnd=[],animating=[],history=[],comparable={};state=state||{};while(--length>-1){start=this.byStart[index];end=this.byEnd[index];if(!start._id){byStart.push(start);byEnd.push(end)}if(start._id){if(start._id!==removeId){byStart.push(start)}if(end._id!==removeId){byEnd.push(end)}if(start._id===removeId){indexWasAt=index;track=start}}index++}length=this.animating.length;index=0;if(length){while(--length>-1){animate=this.animating[index];if(!animate._id){animating.push(animate)}if(animate._id&&animate._id!==removeId){animating.push(animate)}index++}}if(indexWasAt<=this.startIndex){this.startIndex--}if(indexWasAt<=this.endIndex){this.endIndex--}this.byStart=byStart;this.byEnd=byEnd;this.animating=animating;this.count--;historyLen=this.parent.data.history.length;for(var i=0;i<historyLen;i++){if(this.parent.data.history[i]!==removeId){history.push(this.parent.data.history[i])}}this.parent.data.history=history};function getPreviousProperties(oldOptions,newOptions){var matchProps={};for(var prop in oldOptions){if(hasOwn.call(newOptions,prop)&&hasOwn.call(oldOptions,prop)){matchProps[prop]=oldOptions[prop]}}return matchProps}Popcorn.addTrackEvent=function(obj,track){var temp;if(track instanceof TrackEvent){return}track=new TrackEvent(track);if(track&&track._natives&&track._natives.type&&obj.options.defaults&&obj.options.defaults[track._natives.type]){temp=Popcorn.extend({},track);Popcorn.extend(track,obj.options.defaults[track._natives.type],temp)}if(track._natives){track._id=track.id||track._id||Popcorn.guid(track._natives.type);if(track._natives._setup){track._natives._setup.call(obj,track);obj.emit("tracksetup",Popcorn.extend({},track,{plugin:track._natives.type,type:"tracksetup",track:track}))}}obj.data.trackEvents.add(track);TrackEvent.start(obj,track);this.timeUpdate(obj,null,true);if(track._id){Popcorn.addTrackEvent.ref(obj,track)}obj.emit("trackadded",Popcorn.extend({},track,track._natives?{plugin:track._natives.type}:{},{type:"trackadded",track:track}))};Popcorn.addTrackEvent.ref=function(obj,track){obj.data.trackRefs[track._id]=track;return obj};Popcorn.removeTrackEvent=function(obj,removeId){var track=obj.getTrackEvent(removeId);if(!track){return}if(track._natives._teardown){track._natives._teardown.call(obj,track)}obj.data.trackEvents.remove(removeId);Popcorn.removeTrackEvent.ref(obj,removeId);if(track._natives){obj.emit("trackremoved",Popcorn.extend({},track,{plugin:track._natives.type,type:"trackremoved",track:track}))}};Popcorn.removeTrackEvent.ref=function(obj,removeId){delete obj.data.trackRefs[removeId];return obj};Popcorn.getTrackEvents=function(obj){var trackevents=[],refs=obj.data.trackEvents.byStart,length=refs.length,idx=0,ref;for(;idx<length;idx++){ref=refs[idx];if(ref._id){trackevents.push(ref)}}return trackevents};Popcorn.getTrackEvents.ref=function(obj){return obj.data.trackRefs};Popcorn.getTrackEvent=function(obj,trackId){return obj.data.trackRefs[trackId]};Popcorn.getTrackEvent.ref=function(obj,trackId){return obj.data.trackRefs[trackId]};Popcorn.getLastTrackEventId=function(obj){return obj.data.history[obj.data.history.length-1]};Popcorn.timeUpdate=function(obj,event){var currentTime=obj.media.currentTime,previousTime=obj.data.trackEvents.previousUpdateTime,tracks=obj.data.trackEvents,end=tracks.endIndex,start=tracks.startIndex,byStartLen=tracks.byStart.length,byEndLen=tracks.byEnd.length,registryByName=Popcorn.registryByName,trackstart="trackstart",trackend="trackend",byEnd,byStart,byAnimate,natives,type,runningPlugins;if(previousTime<=currentTime){while(tracks.byEnd[end]&&tracks.byEnd[end].end<=currentTime){byEnd=tracks.byEnd[end];natives=byEnd._natives;type=natives&&natives.type;if(!natives||!!registryByName[type]||!!obj[type]){if(byEnd._running===true){byEnd._running=false;runningPlugins=obj.data.running[type];runningPlugins.splice(runningPlugins.indexOf(byEnd),1);if(!obj.data.disabled[type]){natives.end.call(obj,event,byEnd);obj.emit(trackend,Popcorn.extend({},byEnd,{plugin:type,type:trackend,track:byEnd}))}}end++}else{Popcorn.removeTrackEvent(obj,byEnd._id);return}}while(tracks.byStart[start]&&tracks.byStart[start].start<=currentTime){byStart=tracks.byStart[start];natives=byStart._natives;type=natives&&natives.type;if(!natives||!!registryByName[type]||!!obj[type]){if(byStart.end>currentTime&&byStart._running===false){byStart._running=true;obj.data.running[type].push(byStart);if(!obj.data.disabled[type]){natives.start.call(obj,event,byStart);obj.emit(trackstart,Popcorn.extend({},byStart,{plugin:type,type:trackstart,track:byStart}))}}start++}else{Popcorn.removeTrackEvent(obj,byStart._id);return}}}else if(previousTime>currentTime){while(tracks.byStart[start]&&tracks.byStart[start].start>currentTime){byStart=tracks.byStart[start];natives=byStart._natives;type=natives&&natives.type;if(!natives||!!registryByName[type]||!!obj[type]){if(byStart._running===true){byStart._running=false;runningPlugins=obj.data.running[type];runningPlugins.splice(runningPlugins.indexOf(byStart),1);if(!obj.data.disabled[type]){natives.end.call(obj,event,byStart);obj.emit(trackend,Popcorn.extend({},byStart,{plugin:type,type:trackend,track:byStart}))}}start--}else{Popcorn.removeTrackEvent(obj,byStart._id);return}}while(tracks.byEnd[end]&&tracks.byEnd[end].end>currentTime){byEnd=tracks.byEnd[end];natives=byEnd._natives;type=natives&&natives.type;if(!natives||!!registryByName[type]||!!obj[type]){if(byEnd.start<=currentTime&&byEnd._running===false){byEnd._running=true;obj.data.running[type].push(byEnd);if(!obj.data.disabled[type]){natives.start.call(obj,event,byEnd);obj.emit(trackstart,Popcorn.extend({},byEnd,{plugin:type,type:trackstart,track:byEnd}))}}end--}else{Popcorn.removeTrackEvent(obj,byEnd._id);return}}}tracks.endIndex=end;tracks.startIndex=start;tracks.previousUpdateTime=currentTime;tracks.byStart.length<byStartLen&&tracks.startIndex--;tracks.byEnd.length<byEndLen&&tracks.endIndex--};Popcorn.extend(Popcorn.p,{getTrackEvents:function(){return Popcorn.getTrackEvents.call(null,this)},getTrackEvent:function(id){return Popcorn.getTrackEvent.call(null,this,id)},getLastTrackEventId:function(){return Popcorn.getLastTrackEventId.call(null,this)},removeTrackEvent:function(id){Popcorn.removeTrackEvent.call(null,this,id);return this},removePlugin:function(name){Popcorn.removePlugin.call(null,this,name);return this},timeUpdate:function(event){Popcorn.timeUpdate.call(null,this,event);return this},destroy:function(){Popcorn.destroy.call(null,this);return this}});Popcorn.manifest={};Popcorn.registry=[];Popcorn.registryByName={};Popcorn.plugin=function(name,definition,manifest){if(Popcorn.protect.natives.indexOf(name.toLowerCase())>=0){Popcorn.error("'"+name+"' is a protected function name");return}var isfn=typeof definition==="function",blacklist=["start","end","type","manifest"],methods=["_setup","_teardown","start","end","frame"],plugin={},setup;var combineFn=function(first,second){first=first||Popcorn.nop;second=second||Popcorn.nop;return function(){first.apply(this,arguments);second.apply(this,arguments)}};Popcorn.manifest[name]=manifest=manifest||definition.manifest||{};methods.forEach(function(method){definition[method]=safeTry(definition[method]||Popcorn.nop,name)});var pluginFn=function(setup,options){if(!options){return this}if(options.ranges&&Popcorn.isArray(options.ranges)){Popcorn.forEach(options.ranges,function(range){var opts=Popcorn.extend({},options,range);delete opts.ranges;this[name](opts)},this);return this}var natives=options._natives={},compose="",originalOpts,manifestOpts;Popcorn.extend(natives,setup);options._natives.type=options._natives.plugin=name;options._running=false;natives.start=natives.start||natives["in"];natives.end=natives.end||natives["out"];if(options.once){natives.end=combineFn(natives.end,function(){this.removeTrackEvent(options._id)})}natives._teardown=combineFn(function(){var args=slice.call(arguments),runningPlugins=this.data.running[natives.type];args.unshift(null);args[1]._running&&runningPlugins.splice(runningPlugins.indexOf(options),1)&&natives.end.apply(this,args);args[1]._running=false;this.emit("trackend",Popcorn.extend({},options,{plugin:natives.type,type:"trackend",track:Popcorn.getTrackEvent(this,options.id||options._id)}))},natives._teardown);natives._teardown=combineFn(natives._teardown,function(){this.emit("trackteardown",Popcorn.extend({},options,{plugin:name,type:"trackteardown",track:Popcorn.getTrackEvent(this,options.id||options._id)}))});options.compose=options.compose||[];if(typeof options.compose==="string"){options.compose=options.compose.split(" ")}options.effect=options.effect||[];if(typeof options.effect==="string"){options.effect=options.effect.split(" ")}options.compose=options.compose.concat(options.effect);options.compose.forEach(function(composeOption){compose=Popcorn.compositions[composeOption]||{};methods.forEach(function(method){natives[method]=combineFn(natives[method],compose[method])})});options._natives.manifest=manifest;if(!("start"in options)){options.start=options["in"]||0}if(!options.end&&options.end!==0){options.end=options["out"]||Number.MAX_VALUE}if(!hasOwn.call(options,"toString")){options.toString=function(){var props=["start: "+options.start,"end: "+options.end,"id: "+(options.id||options._id)];if(options.target!=null){props.push("target: "+options.target)}return name+" ( "+props.join(", ")+" )"}}if(!options.target){manifestOpts="options"in manifest&&manifest.options;options.target=manifestOpts&&"target"in manifestOpts&&manifestOpts.target}if(!options._id&&options._natives){options._id=Popcorn.guid(options._natives.type)}if(options instanceof TrackEvent){if(options._natives){options._id=options.id||options._id||Popcorn.guid(options._natives.type);if(options._natives._setup){options._natives._setup.call(this,options);this.emit("tracksetup",Popcorn.extend({},options,{plugin:options._natives.type,type:"tracksetup",track:options}))}}this.data.trackEvents.add(options);TrackEvent.start(this,options);this.timeUpdate(this,null,true);if(options._id){Popcorn.addTrackEvent.ref(this,options)}}else{Popcorn.addTrackEvent(this,options)}Popcorn.forEach(setup,function(callback,type){if(blacklist.indexOf(type)===-1){this.on(type,callback)}},this);return this};Popcorn.p[name]=plugin[name]=function(id,options){var length=arguments.length,trackEvent,defaults,mergedSetupOpts,previousOpts,newOpts;if(id&&!options){options=id;id=null}else{trackEvent=this.getTrackEvent(id);if(!trackEvent){options.id=id}else{newOpts=options;previousOpts=getPreviousProperties(trackEvent,newOpts);if(trackEvent._natives._update){this.data.trackEvents.remove(trackEvent);if(hasOwn.call(options,"start")){trackEvent.start=options.start}if(hasOwn.call(options,"end")){trackEvent.end=options.end}TrackEvent.end(this,trackEvent);if(isfn){definition.call(this,trackEvent)}trackEvent._natives._update.call(this,trackEvent,options);this.data.trackEvents.add(trackEvent);TrackEvent.start(this,trackEvent)}else{Popcorn.extend(trackEvent,options);this.data.trackEvents.remove(id);if(trackEvent._natives._teardown){trackEvent._natives._teardown.call(this,trackEvent)}Popcorn.removeTrackEvent.ref(this,id);if(isfn){pluginFn.call(this,definition.call(this,trackEvent),trackEvent)}else{trackEvent._id=trackEvent.id||trackEvent._id||Popcorn.guid(trackEvent._natives.type);if(trackEvent._natives&&trackEvent._natives._setup){trackEvent._natives._setup.call(this,trackEvent);this.emit("tracksetup",Popcorn.extend({},trackEvent,{plugin:trackEvent._natives.type,type:"tracksetup",track:trackEvent}))}this.data.trackEvents.add(trackEvent);TrackEvent.start(this,trackEvent);this.timeUpdate(this,null,true);Popcorn.addTrackEvent.ref(this,trackEvent)}this.emit("trackchange",{id:trackEvent.id,type:"trackchange",previousValue:previousOpts,currentValue:trackEvent,track:trackEvent});return this}if(trackEvent._natives.type!=="cue"){this.emit("trackchange",{id:trackEvent.id,type:"trackchange",previousValue:previousOpts,currentValue:newOpts,track:trackEvent})}return this}}this.data.running[name]=this.data.running[name]||[];defaults=this.options.defaults&&this.options.defaults[name]||{};mergedSetupOpts=Popcorn.extend({},defaults,options);pluginFn.call(this,isfn?definition.call(this,mergedSetupOpts):definition,mergedSetupOpts);return this};if(manifest){Popcorn.extend(definition,{manifest:manifest})}var entry={fn:plugin[name],definition:definition,base:definition,parents:[],name:name};Popcorn.registry.push(Popcorn.extend(plugin,entry,{type:name}));Popcorn.registryByName[name]=entry;return plugin};Popcorn.plugin.errors=[];function safeTry(fn,pluginName){return function(){if(Popcorn.plugin.debug){return fn.apply(this,arguments)}try{return fn.apply(this,arguments)}catch(ex){Popcorn.plugin.errors.push({plugin:pluginName,thrown:ex,source:fn.toString()});this.emit("pluginerror",Popcorn.plugin.errors)}}}Popcorn.plugin.debug=Popcorn.version==="@"+"VERSION";Popcorn.removePlugin=function(obj,name){if(!name){name=obj;obj=Popcorn.p;if(Popcorn.protect.natives.indexOf(name.toLowerCase())>=0){Popcorn.error("'"+name+"' is a protected function name");return}var registryLen=Popcorn.registry.length,registryIdx;for(registryIdx=0;registryIdx<registryLen;registryIdx++){if(Popcorn.registry[registryIdx].name===name){Popcorn.registry.splice(registryIdx,1);delete Popcorn.registryByName[name];delete Popcorn.manifest[name];delete obj[name];return}}}var byStart=obj.data.trackEvents.byStart,byEnd=obj.data.trackEvents.byEnd,animating=obj.data.trackEvents.animating,idx,sl;for(idx=0,sl=byStart.length;idx<sl;idx++){if(byStart[idx]&&byStart[idx]._natives&&byStart[idx]._natives.type===name){byStart[idx]._natives._teardown&&byStart[idx]._natives._teardown.call(obj,byStart[idx]);byStart.splice(idx,1);idx--;sl--;if(obj.data.trackEvents.startIndex<=idx){obj.data.trackEvents.startIndex--;obj.data.trackEvents.endIndex--}}if(byEnd[idx]&&byEnd[idx]._natives&&byEnd[idx]._natives.type===name){byEnd.splice(idx,1)}}for(idx=0,sl=animating.length;idx<sl;idx++){if(animating[idx]&&animating[idx]._natives&&animating[idx]._natives.type===name){animating.splice(idx,1);idx--;sl--}}};Popcorn.compositions={};Popcorn.compose=function(name,definition,manifest){Popcorn.manifest[name]=manifest=manifest||definition.manifest||{};Popcorn.compositions[name]=definition};Popcorn.plugin.effect=Popcorn.effect=Popcorn.compose;var rnaiveExpr=/^(?:\.|#|\[)/;Popcorn.dom={debug:false,find:function(selector,context){var node=null;context=context||document;if(selector){if(!rnaiveExpr.test(selector)){node=document.getElementById(selector);
if(node!==null){return node}}try{node=context.querySelector(selector)}catch(e){if(Popcorn.dom.debug){throw new Error(e)}}}return node}};var rparams=/\?/,setup={ajax:null,url:"",data:"",dataType:"",success:Popcorn.nop,type:"GET",async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8"};Popcorn.xhr=function(options){var settings;options.dataType=options.dataType&&options.dataType.toLowerCase()||null;if(options.dataType&&(options.dataType==="jsonp"||options.dataType==="script")){Popcorn.xhr.getJSONP(options.url,options.success,options.dataType==="script");return}settings=Popcorn.extend({},setup,options);settings.ajax=new XMLHttpRequest;if(settings.ajax){if(settings.type==="GET"&&settings.data){settings.url+=(rparams.test(settings.url)?"&":"?")+settings.data;settings.data=null}settings.ajax.open(settings.type,settings.url,settings.async);if(settings.type==="POST"){settings.ajax.setRequestHeader("Content-Type",settings.contentType)}settings.ajax.send(settings.data||null);return Popcorn.xhr.httpData(settings)}};Popcorn.xhr.httpData=function(settings){var data,json=null,parser,xml=null;settings.ajax.onreadystatechange=function(){if(settings.ajax.readyState===4){try{json=JSON.parse(settings.ajax.responseText)}catch(e){}data={xml:settings.ajax.responseXML,text:settings.ajax.responseText,json:json};if(!data.xml||!data.xml.documentElement){data.xml=null;try{parser=new DOMParser;xml=parser.parseFromString(settings.ajax.responseText,"text/xml");if(!xml.getElementsByTagName("parsererror").length){data.xml=xml}}catch(e){}}if(settings.dataType){data=data[settings.dataType]}settings.success.call(settings.ajax,data)}};return data};Popcorn.xhr.getJSONP=function(url,success,isScript){var head=document.head||document.getElementsByTagName("head")[0]||document.documentElement,script=document.createElement("script"),isFired=false,params=[],rjsonp=/(=)\?(?=&|$)|\?\?/,replaceInUrl,prefix,paramStr,callback,callparam;if(!isScript){callparam=url.match(/(callback=[^&]*)/);if(callparam!==null&&callparam.length){prefix=callparam[1].split("=")[1];if(prefix==="?"){prefix="jsonp"}callback=Popcorn.guid(prefix);url=url.replace(/(callback=[^&]*)/,"callback="+callback)}else{callback=Popcorn.guid("jsonp");if(rjsonp.test(url)){url=url.replace(rjsonp,"$1"+callback)}params=url.split(/\?(.+)?/);url=params[0]+"?";if(params[1]){url+=params[1]+"&"}url+="callback="+callback}window[callback]=function(data){success&&success(data);isFired=true}}script.addEventListener("load",function(){if(isScript){success&&success()}if(isFired){delete window[callback]}head.removeChild(script)},false);script.addEventListener("error",function(e){success&&success({error:e});if(!isScript){delete window[callback]}head.removeChild(script)},false);script.src=url;head.insertBefore(script,head.firstChild);return};Popcorn.getJSONP=Popcorn.xhr.getJSONP;Popcorn.getScript=Popcorn.xhr.getScript=function(url,success){return Popcorn.xhr.getJSONP(url,success,true)};Popcorn.util={toSeconds:function(timeStr,framerate){var validTimeFormat=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,errorMessage="Invalid time format",digitPairs,lastIndex,lastPair,firstPair,frameInfo,frameTime;if(typeof timeStr==="number"){return timeStr}if(typeof timeStr==="string"&&!validTimeFormat.test(timeStr)){Popcorn.error(errorMessage)}digitPairs=timeStr.split(":");lastIndex=digitPairs.length-1;lastPair=digitPairs[lastIndex];if(lastPair.indexOf(";")>-1){frameInfo=lastPair.split(";");frameTime=0;if(framerate&&typeof framerate==="number"){frameTime=parseFloat(frameInfo[1],10)/framerate}digitPairs[lastIndex]=parseInt(frameInfo[0],10)+frameTime}firstPair=digitPairs[0];return{1:parseFloat(firstPair,10),2:parseInt(firstPair,10)*60+parseFloat(digitPairs[1],10),3:parseInt(firstPair,10)*3600+parseInt(digitPairs[1],10)*60+parseFloat(digitPairs[2],10)}[digitPairs.length||1]}};Popcorn.p.cue=Popcorn.p.exec;Popcorn.protect={natives:getKeys(Popcorn.p).map(function(val){return val.toLowerCase()})};Popcorn.forEach({listen:"on",unlisten:"off",trigger:"emit",exec:"cue"},function(recommend,api){var original=Popcorn.p[api];Popcorn.p[api]=function(){if(typeof console!=="undefined"&&console.warn){console.warn("Deprecated method '"+api+"', "+(recommend==null?"do not use.":"use '"+recommend+"' instead."));Popcorn.p[api]=original}return Popcorn.p[recommend].apply(this,[].slice.call(arguments))}});global.Popcorn=Popcorn})(window,window.document);(function(Popcorn){var combineFn=function(first,second){first=first||Popcorn.nop;second=second||Popcorn.nop;return function(){first.apply(this,arguments);second.apply(this,arguments)}};var rIdExp=/^(#([\w\-\_\.]+))$/;Popcorn.player=function(name,player){if(Popcorn[name]){return}player=player||{};var playerFn=function(target,src,options){options=options||{};var date=new Date/1e3,baselineTime=date,currentTime=0,readyState=0,volume=1,muted=false,events={},container=typeof target==="string"?Popcorn.dom.find(target):target,basePlayer={},timeout,popcorn;if(!Object.prototype.__defineGetter__){basePlayer=container||document.createElement("div")}for(var val in container){if(val in basePlayer){continue}if(typeof container[val]==="object"){basePlayer[val]=container[val]}else if(typeof container[val]==="function"){basePlayer[val]=function(value){if("length"in container[value]&&!container[value].call){return container[value]}else{return function(){return container[value].apply(container,arguments)}}}(val)}else{Popcorn.player.defineProperty(basePlayer,val,{get:function(value){return function(){return container[value]}}(val),set:Popcorn.nop,configurable:true})}}var timeupdate=function(){date=new Date/1e3;if(!basePlayer.paused){basePlayer.currentTime=basePlayer.currentTime+(date-baselineTime);basePlayer.dispatchEvent("timeupdate");timeout=setTimeout(timeupdate,10)}baselineTime=date};basePlayer.play=function(){this.paused=false;if(basePlayer.readyState>=4){baselineTime=new Date/1e3;basePlayer.dispatchEvent("play");timeupdate()}};basePlayer.pause=function(){this.paused=true;basePlayer.dispatchEvent("pause")};Popcorn.player.defineProperty(basePlayer,"currentTime",{get:function(){return currentTime},set:function(val){currentTime=+val;basePlayer.dispatchEvent("timeupdate");return currentTime},configurable:true});Popcorn.player.defineProperty(basePlayer,"volume",{get:function(){return volume},set:function(val){volume=+val;basePlayer.dispatchEvent("volumechange");return volume},configurable:true});Popcorn.player.defineProperty(basePlayer,"muted",{get:function(){return muted},set:function(val){muted=+val;basePlayer.dispatchEvent("volumechange");return muted},configurable:true});Popcorn.player.defineProperty(basePlayer,"readyState",{get:function(){return readyState},set:function(val){readyState=val;return readyState},configurable:true});basePlayer.addEventListener=function(evtName,fn){if(!events[evtName]){events[evtName]=[]}events[evtName].push(fn);return fn};basePlayer.removeEventListener=function(evtName,fn){var i,listeners=events[evtName];if(!listeners){return}for(i=events[evtName].length-1;i>=0;i--){if(fn===listeners[i]){listeners.splice(i,1)}}return fn};basePlayer.dispatchEvent=function(oEvent){var evt,self=this,eventInterface,eventName=oEvent.type;if(!eventName){eventName=oEvent;eventInterface=Popcorn.events.getInterface(eventName);if(eventInterface){evt=document.createEvent(eventInterface);evt.initEvent(eventName,true,true,window,1)}}if(events[eventName]){for(var i=events[eventName].length-1;i>=0;i--){events[eventName][i].call(self,evt,self)}}};basePlayer.src=src||"";basePlayer.duration=0;basePlayer.paused=true;basePlayer.ended=0;options&&options.events&&Popcorn.forEach(options.events,function(val,key){basePlayer.addEventListener(key,val,false)});if(player._canPlayType(container.nodeName,src)!==false){if(player._setup){player._setup.call(basePlayer,options)}else{basePlayer.readyState=4;basePlayer.dispatchEvent("loadedmetadata");basePlayer.dispatchEvent("loadeddata");basePlayer.dispatchEvent("canplaythrough")}}else{setTimeout(function(){basePlayer.dispatchEvent("error")},0)}popcorn=new Popcorn.p.init(basePlayer,options);if(player._teardown){popcorn.destroy=combineFn(popcorn.destroy,function(){player._teardown.call(basePlayer,options)})}return popcorn};playerFn.canPlayType=player._canPlayType=player._canPlayType||Popcorn.nop;Popcorn[name]=Popcorn.player.registry[name]=playerFn};Popcorn.player.registry={};Popcorn.player.defineProperty=Object.defineProperty||function(object,description,options){object.__defineGetter__(description,options.get||Popcorn.nop);object.__defineSetter__(description,options.set||Popcorn.nop)};Popcorn.player.playerQueue=function(){var _queue=[],_running=false;return{next:function(){_running=false;_queue.shift();_queue[0]&&_queue[0]()},add:function(callback){_queue.push(function(){_running=true;callback&&callback()});!_running&&_queue[0]()}}};Popcorn.smart=function(target,src,options){var node=typeof target==="string"?Popcorn.dom.find(target):target,i,srci,j,media,mediaWrapper,popcorn,srcLength,wrappers="HTMLYouTubeVideoElement HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(!node){Popcorn.error("Specified target `"+target+"` was not found.");return}src=typeof src==="string"?[src]:src;for(i=0,srcLength=src.length;i<srcLength;i++){srci=src[i];for(j=0;j<wrappers.length;j++){mediaWrapper=Popcorn[wrappers[j]];if(mediaWrapper&&mediaWrapper._canPlaySrc(srci)==="probably"){media=mediaWrapper(node);popcorn=Popcorn(media,options);setTimeout(function(){media.src=srci},0);return popcorn}}for(var key in Popcorn.player.registry){if(Popcorn.player.registry.hasOwnProperty(key)){if(Popcorn.player.registry[key].canPlayType(node.nodeName,srci)){return Popcorn[key](node,srci,options)}}}}var videoHTML,videoElement,videoID=Popcorn.guid("popcorn-video-"),videoHTMLContainer=document.createElement("div");videoHTMLContainer.style.width="100%";videoHTMLContainer.style.height="100%";if(src.length===1){videoElement=document.createElement("video");videoElement.id=videoID;node.appendChild(videoElement);setTimeout(function(){var decodeDiv=document.createElement("div");decodeDiv.innerHTML=src[0];videoElement.src=decodeDiv.firstChild.nodeValue},0);return Popcorn("#"+videoID,options)}node.appendChild(videoHTMLContainer);videoHTML='<video id="'+videoID+'" preload=auto autobuffer>';for(i=0,srcLength=src.length;i<srcLength;i++){videoHTML+='<source src="'+src[i]+'">'}videoHTML+="</video>";videoHTMLContainer.innerHTML=videoHTML;if(options&&options.events&&options.events.error){node.addEventListener("error",options.events.error,false)}return Popcorn("#"+videoID,options)}})(Popcorn);(function(Popcorn){var combineFn=function(first,second){first=first||Popcorn.nop;second=second||Popcorn.nop;return function(){first.apply(this,arguments);second.apply(this,arguments)}};var rIdExp=/^(#([\w\-\_\.]+))$/;Popcorn.player=function(name,player){if(Popcorn[name]){return}player=player||{};var playerFn=function(target,src,options){options=options||{};var date=new Date/1e3,baselineTime=date,currentTime=0,readyState=0,volume=1,muted=false,events={},container=typeof target==="string"?Popcorn.dom.find(target):target,basePlayer={},timeout,popcorn;if(!Object.prototype.__defineGetter__){basePlayer=container||document.createElement("div")}for(var val in container){if(val in basePlayer){continue}if(typeof container[val]==="object"){basePlayer[val]=container[val]}else if(typeof container[val]==="function"){basePlayer[val]=function(value){if("length"in container[value]&&!container[value].call){return container[value]}else{return function(){return container[value].apply(container,arguments)}}}(val)}else{Popcorn.player.defineProperty(basePlayer,val,{get:function(value){return function(){return container[value]}}(val),set:Popcorn.nop,configurable:true})}}var timeupdate=function(){date=new Date/1e3;if(!basePlayer.paused){basePlayer.currentTime=basePlayer.currentTime+(date-baselineTime);basePlayer.dispatchEvent("timeupdate");timeout=setTimeout(timeupdate,10)}baselineTime=date};basePlayer.play=function(){this.paused=false;if(basePlayer.readyState>=4){baselineTime=new Date/1e3;basePlayer.dispatchEvent("play");timeupdate()}};basePlayer.pause=function(){this.paused=true;basePlayer.dispatchEvent("pause")};Popcorn.player.defineProperty(basePlayer,"currentTime",{get:function(){return currentTime},set:function(val){currentTime=+val;basePlayer.dispatchEvent("timeupdate");return currentTime},configurable:true});Popcorn.player.defineProperty(basePlayer,"volume",{get:function(){return volume},set:function(val){volume=+val;basePlayer.dispatchEvent("volumechange");return volume},configurable:true});Popcorn.player.defineProperty(basePlayer,"muted",{get:function(){return muted},set:function(val){muted=+val;basePlayer.dispatchEvent("volumechange");return muted},configurable:true});Popcorn.player.defineProperty(basePlayer,"readyState",{get:function(){return readyState},set:function(val){readyState=val;return readyState},configurable:true});basePlayer.addEventListener=function(evtName,fn){if(!events[evtName]){events[evtName]=[]}events[evtName].push(fn);return fn};basePlayer.removeEventListener=function(evtName,fn){var i,listeners=events[evtName];if(!listeners){return}for(i=events[evtName].length-1;i>=0;i--){if(fn===listeners[i]){listeners.splice(i,1)}}return fn};basePlayer.dispatchEvent=function(oEvent){var evt,self=this,eventInterface,eventName=oEvent.type;if(!eventName){eventName=oEvent;eventInterface=Popcorn.events.getInterface(eventName);if(eventInterface){evt=document.createEvent(eventInterface);evt.initEvent(eventName,true,true,window,1)}}if(events[eventName]){for(var i=events[eventName].length-1;i>=0;i--){events[eventName][i].call(self,evt,self)}}};basePlayer.src=src||"";basePlayer.duration=0;basePlayer.paused=true;basePlayer.ended=0;options&&options.events&&Popcorn.forEach(options.events,function(val,key){basePlayer.addEventListener(key,val,false)});if(player._canPlayType(container.nodeName,src)!==false){if(player._setup){player._setup.call(basePlayer,options)}else{basePlayer.readyState=4;basePlayer.dispatchEvent("loadedmetadata");basePlayer.dispatchEvent("loadeddata");basePlayer.dispatchEvent("canplaythrough")}}else{setTimeout(function(){basePlayer.dispatchEvent("error")},0)}popcorn=new Popcorn.p.init(basePlayer,options);if(player._teardown){popcorn.destroy=combineFn(popcorn.destroy,function(){player._teardown.call(basePlayer,options)})}return popcorn};playerFn.canPlayType=player._canPlayType=player._canPlayType||Popcorn.nop;Popcorn[name]=Popcorn.player.registry[name]=playerFn};Popcorn.player.registry={};Popcorn.player.defineProperty=Object.defineProperty||function(object,description,options){object.__defineGetter__(description,options.get||Popcorn.nop);object.__defineSetter__(description,options.set||Popcorn.nop)};Popcorn.player.playerQueue=function(){var _queue=[],_running=false;return{next:function(){_running=false;_queue.shift();_queue[0]&&_queue[0]()},add:function(callback){_queue.push(function(){_running=true;callback&&callback()});!_running&&_queue[0]()}}};Popcorn.smart=function(target,src,options){var node=typeof target==="string"?Popcorn.dom.find(target):target,i,srci,j,media,mediaWrapper,popcorn,srcLength,wrappers="HTMLYouTubeVideoElement HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(!node){Popcorn.error("Specified target `"+target+"` was not found.");return}src=typeof src==="string"?[src]:src;for(i=0,srcLength=src.length;i<srcLength;i++){srci=src[i];for(j=0;j<wrappers.length;j++){mediaWrapper=Popcorn[wrappers[j]];if(mediaWrapper&&mediaWrapper._canPlaySrc(srci)==="probably"){media=mediaWrapper(node);popcorn=Popcorn(media,options);setTimeout(function(){media.src=srci},0);return popcorn}}for(var key in Popcorn.player.registry){if(Popcorn.player.registry.hasOwnProperty(key)){if(Popcorn.player.registry[key].canPlayType(node.nodeName,srci)){return Popcorn[key](node,srci,options)}}}}var videoHTML,videoElement,videoID=Popcorn.guid("popcorn-video-"),videoHTMLContainer=document.createElement("div");videoHTMLContainer.style.width="100%";videoHTMLContainer.style.height="100%";if(src.length===1){videoElement=document.createElement("video");videoElement.id=videoID;node.appendChild(videoElement);setTimeout(function(){var decodeDiv=document.createElement("div");decodeDiv.innerHTML=src[0];videoElement.src=decodeDiv.firstChild.nodeValue},0);return Popcorn("#"+videoID,options)}node.appendChild(videoHTMLContainer);videoHTML='<video id="'+videoID+'" preload=auto autobuffer>';for(i=0,srcLength=src.length;i<srcLength;i++){videoHTML+='<source src="'+src[i]+'">'}videoHTML+="</video>";videoHTMLContainer.innerHTML=videoHTML;if(options&&options.events&&options.events.error){node.addEventListener("error",options.events.error,false)}return Popcorn("#"+videoID,options)}})(Popcorn);(function(window,Popcorn){Popcorn.player("soundcloud",{_canPlayType:function(nodeName,url){return typeof url==="string"&&Popcorn.HTMLSoundCloudAudioElement._canPlaySrc(url)&&nodeName.toLowerCase()!=="audio"}});Popcorn.soundcloud=function(container,url,options){if(typeof console!=="undefined"&&console.warn){console.warn("Deprecated player 'soundcloud'. Please use Popcorn.HTMLSoundCloudAudioElement directly.")}var media=Popcorn.HTMLSoundCloudAudioElement(container),popcorn=Popcorn(media,options);setTimeout(function(){media.src=url},0);return popcorn}})(window,Popcorn);(function(Popcorn){var combineFn=function(first,second){first=first||Popcorn.nop;second=second||Popcorn.nop;return function(){first.apply(this,arguments);second.apply(this,arguments)}};var rIdExp=/^(#([\w\-\_\.]+))$/;Popcorn.player=function(name,player){if(Popcorn[name]){return}player=player||{};var playerFn=function(target,src,options){options=options||{};var date=new Date/1e3,baselineTime=date,currentTime=0,readyState=0,volume=1,muted=false,events={},container=typeof target==="string"?Popcorn.dom.find(target):target,basePlayer={},timeout,popcorn;if(!Object.prototype.__defineGetter__){basePlayer=container||document.createElement("div")}for(var val in container){if(val in basePlayer){continue}if(typeof container[val]==="object"){basePlayer[val]=container[val]}else if(typeof container[val]==="function"){basePlayer[val]=function(value){if("length"in container[value]&&!container[value].call){return container[value]}else{return function(){return container[value].apply(container,arguments)}}}(val)}else{Popcorn.player.defineProperty(basePlayer,val,{get:function(value){return function(){return container[value]}}(val),set:Popcorn.nop,configurable:true})}}var timeupdate=function(){date=new Date/1e3;if(!basePlayer.paused){basePlayer.currentTime=basePlayer.currentTime+(date-baselineTime);basePlayer.dispatchEvent("timeupdate");timeout=setTimeout(timeupdate,10)}baselineTime=date};basePlayer.play=function(){this.paused=false;if(basePlayer.readyState>=4){baselineTime=new Date/1e3;basePlayer.dispatchEvent("play");timeupdate()}};basePlayer.pause=function(){this.paused=true;basePlayer.dispatchEvent("pause")};Popcorn.player.defineProperty(basePlayer,"currentTime",{get:function(){return currentTime},set:function(val){currentTime=+val;basePlayer.dispatchEvent("timeupdate");return currentTime},configurable:true});Popcorn.player.defineProperty(basePlayer,"volume",{get:function(){return volume},set:function(val){volume=+val;basePlayer.dispatchEvent("volumechange");return volume},configurable:true});Popcorn.player.defineProperty(basePlayer,"muted",{get:function(){return muted},set:function(val){muted=+val;basePlayer.dispatchEvent("volumechange");return muted},configurable:true});Popcorn.player.defineProperty(basePlayer,"readyState",{get:function(){return readyState},set:function(val){readyState=val;return readyState},configurable:true});basePlayer.addEventListener=function(evtName,fn){if(!events[evtName]){events[evtName]=[]}events[evtName].push(fn);return fn};basePlayer.removeEventListener=function(evtName,fn){var i,listeners=events[evtName];if(!listeners){return}for(i=events[evtName].length-1;i>=0;i--){if(fn===listeners[i]){listeners.splice(i,1)}}return fn};basePlayer.dispatchEvent=function(oEvent){var evt,self=this,eventInterface,eventName=oEvent.type;if(!eventName){eventName=oEvent;eventInterface=Popcorn.events.getInterface(eventName);if(eventInterface){evt=document.createEvent(eventInterface);evt.initEvent(eventName,true,true,window,1)}}if(events[eventName]){for(var i=events[eventName].length-1;i>=0;i--){events[eventName][i].call(self,evt,self)}}};basePlayer.src=src||"";basePlayer.duration=0;basePlayer.paused=true;basePlayer.ended=0;options&&options.events&&Popcorn.forEach(options.events,function(val,key){basePlayer.addEventListener(key,val,false)});if(player._canPlayType(container.nodeName,src)!==false){if(player._setup){player._setup.call(basePlayer,options)}else{basePlayer.readyState=4;basePlayer.dispatchEvent("loadedmetadata");basePlayer.dispatchEvent("loadeddata");basePlayer.dispatchEvent("canplaythrough")}}else{setTimeout(function(){basePlayer.dispatchEvent("error")},0)}popcorn=new Popcorn.p.init(basePlayer,options);if(player._teardown){popcorn.destroy=combineFn(popcorn.destroy,function(){player._teardown.call(basePlayer,options)})}return popcorn};playerFn.canPlayType=player._canPlayType=player._canPlayType||Popcorn.nop;Popcorn[name]=Popcorn.player.registry[name]=playerFn};Popcorn.player.registry={};Popcorn.player.defineProperty=Object.defineProperty||function(object,description,options){object.__defineGetter__(description,options.get||Popcorn.nop);object.__defineSetter__(description,options.set||Popcorn.nop)};Popcorn.player.playerQueue=function(){var _queue=[],_running=false;return{next:function(){_running=false;_queue.shift();_queue[0]&&_queue[0]()},add:function(callback){_queue.push(function(){_running=true;callback&&callback()});!_running&&_queue[0]()}}};Popcorn.smart=function(target,src,options){var node=typeof target==="string"?Popcorn.dom.find(target):target,i,srci,j,media,mediaWrapper,popcorn,srcLength,wrappers="HTMLYouTubeVideoElement HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(!node){Popcorn.error("Specified target `"+target+"` was not found.");return}src=typeof src==="string"?[src]:src;for(i=0,srcLength=src.length;i<srcLength;i++){srci=src[i];for(j=0;j<wrappers.length;j++){mediaWrapper=Popcorn[wrappers[j]];if(mediaWrapper&&mediaWrapper._canPlaySrc(srci)==="probably"){media=mediaWrapper(node);popcorn=Popcorn(media,options);setTimeout(function(){media.src=srci},0);return popcorn}}for(var key in Popcorn.player.registry){if(Popcorn.player.registry.hasOwnProperty(key)){if(Popcorn.player.registry[key].canPlayType(node.nodeName,srci)){return Popcorn[key](node,srci,options)}}}}var videoHTML,videoElement,videoID=Popcorn.guid("popcorn-video-"),videoHTMLContainer=document.createElement("div");videoHTMLContainer.style.width="100%";videoHTMLContainer.style.height="100%";if(src.length===1){videoElement=document.createElement("video");videoElement.id=videoID;node.appendChild(videoElement);setTimeout(function(){var decodeDiv=document.createElement("div");decodeDiv.innerHTML=src[0];videoElement.src=decodeDiv.firstChild.nodeValue},0);return Popcorn("#"+videoID,options)}node.appendChild(videoHTMLContainer);videoHTML='<video id="'+videoID+'" preload=auto autobuffer>';for(i=0,srcLength=src.length;i<srcLength;i++){videoHTML+='<source src="'+src[i]+'">'}videoHTML+="</video>";videoHTMLContainer.innerHTML=videoHTML;if(options&&options.events&&options.events.error){node.addEventListener("error",options.events.error,false)}return Popcorn("#"+videoID,options)}})(Popcorn);(function(window,Popcorn){Popcorn.player("vimeo",{_canPlayType:function(nodeName,url){return typeof url==="string"&&Popcorn.HTMLVimeoVideoElement._canPlaySrc(url)}});Popcorn.vimeo=function(container,url,options){if(typeof console!=="undefined"&&console.warn){console.warn("Deprecated player 'vimeo'. Please use Popcorn.HTMLVimeoVideoElement directly.")}var media=Popcorn.HTMLVimeoVideoElement(container),popcorn=Popcorn(media,options);setTimeout(function(){media.src=url},0);return popcorn}})(window,Popcorn);(function(Popcorn){var combineFn=function(first,second){first=first||Popcorn.nop;second=second||Popcorn.nop;return function(){first.apply(this,arguments);second.apply(this,arguments)}};var rIdExp=/^(#([\w\-\_\.]+))$/;Popcorn.player=function(name,player){if(Popcorn[name]){return}player=player||{};var playerFn=function(target,src,options){options=options||{};var date=new Date/1e3,baselineTime=date,currentTime=0,readyState=0,volume=1,muted=false,events={},container=typeof target==="string"?Popcorn.dom.find(target):target,basePlayer={},timeout,popcorn;if(!Object.prototype.__defineGetter__){basePlayer=container||document.createElement("div")}for(var val in container){if(val in basePlayer){continue}if(typeof container[val]==="object"){basePlayer[val]=container[val]}else if(typeof container[val]==="function"){basePlayer[val]=function(value){if("length"in container[value]&&!container[value].call){return container[value]}else{return function(){return container[value].apply(container,arguments)}}}(val)}else{Popcorn.player.defineProperty(basePlayer,val,{get:function(value){return function(){return container[value]}}(val),set:Popcorn.nop,configurable:true})}}var timeupdate=function(){date=new Date/1e3;if(!basePlayer.paused){basePlayer.currentTime=basePlayer.currentTime+(date-baselineTime);basePlayer.dispatchEvent("timeupdate");timeout=setTimeout(timeupdate,10)}baselineTime=date};basePlayer.play=function(){this.paused=false;if(basePlayer.readyState>=4){baselineTime=new Date/1e3;basePlayer.dispatchEvent("play");timeupdate()}};basePlayer.pause=function(){this.paused=true;basePlayer.dispatchEvent("pause")};Popcorn.player.defineProperty(basePlayer,"currentTime",{get:function(){return currentTime},set:function(val){currentTime=+val;basePlayer.dispatchEvent("timeupdate");return currentTime},configurable:true});Popcorn.player.defineProperty(basePlayer,"volume",{get:function(){return volume},set:function(val){volume=+val;basePlayer.dispatchEvent("volumechange");return volume},configurable:true});Popcorn.player.defineProperty(basePlayer,"muted",{get:function(){return muted},set:function(val){muted=+val;basePlayer.dispatchEvent("volumechange");return muted},configurable:true});Popcorn.player.defineProperty(basePlayer,"readyState",{get:function(){return readyState},set:function(val){readyState=val;return readyState},configurable:true});basePlayer.addEventListener=function(evtName,fn){if(!events[evtName]){events[evtName]=[]}events[evtName].push(fn);return fn};basePlayer.removeEventListener=function(evtName,fn){var i,listeners=events[evtName];if(!listeners){return}for(i=events[evtName].length-1;i>=0;i--){if(fn===listeners[i]){listeners.splice(i,1)}}return fn};basePlayer.dispatchEvent=function(oEvent){var evt,self=this,eventInterface,eventName=oEvent.type;if(!eventName){eventName=oEvent;eventInterface=Popcorn.events.getInterface(eventName);if(eventInterface){evt=document.createEvent(eventInterface);evt.initEvent(eventName,true,true,window,1)}}if(events[eventName]){for(var i=events[eventName].length-1;i>=0;i--){events[eventName][i].call(self,evt,self)}}};basePlayer.src=src||"";basePlayer.duration=0;basePlayer.paused=true;basePlayer.ended=0;options&&options.events&&Popcorn.forEach(options.events,function(val,key){basePlayer.addEventListener(key,val,false)});if(player._canPlayType(container.nodeName,src)!==false){if(player._setup){player._setup.call(basePlayer,options)}else{basePlayer.readyState=4;basePlayer.dispatchEvent("loadedmetadata");basePlayer.dispatchEvent("loadeddata");basePlayer.dispatchEvent("canplaythrough")}}else{setTimeout(function(){basePlayer.dispatchEvent("error")},0)}popcorn=new Popcorn.p.init(basePlayer,options);if(player._teardown){popcorn.destroy=combineFn(popcorn.destroy,function(){player._teardown.call(basePlayer,options)})}return popcorn};playerFn.canPlayType=player._canPlayType=player._canPlayType||Popcorn.nop;Popcorn[name]=Popcorn.player.registry[name]=playerFn};Popcorn.player.registry={};Popcorn.player.defineProperty=Object.defineProperty||function(object,description,options){object.__defineGetter__(description,options.get||Popcorn.nop);object.__defineSetter__(description,options.set||Popcorn.nop)};Popcorn.player.playerQueue=function(){var _queue=[],_running=false;return{next:function(){_running=false;_queue.shift();_queue[0]&&_queue[0]()},add:function(callback){_queue.push(function(){_running=true;callback&&callback()});!_running&&_queue[0]()}}};Popcorn.smart=function(target,src,options){var node=typeof target==="string"?Popcorn.dom.find(target):target,i,srci,j,media,mediaWrapper,popcorn,srcLength,wrappers="HTMLYouTubeVideoElement HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(!node){Popcorn.error("Specified target `"+target+"` was not found.");return}src=typeof src==="string"?[src]:src;for(i=0,srcLength=src.length;i<srcLength;i++){srci=src[i];for(j=0;j<wrappers.length;j++){mediaWrapper=Popcorn[wrappers[j]];if(mediaWrapper&&mediaWrapper._canPlaySrc(srci)==="probably"){media=mediaWrapper(node);popcorn=Popcorn(media,options);setTimeout(function(){media.src=srci},0);return popcorn}}for(var key in Popcorn.player.registry){if(Popcorn.player.registry.hasOwnProperty(key)){if(Popcorn.player.registry[key].canPlayType(node.nodeName,srci)){return Popcorn[key](node,srci,options)}}}}var videoHTML,videoElement,videoID=Popcorn.guid("popcorn-video-"),videoHTMLContainer=document.createElement("div");videoHTMLContainer.style.width="100%";videoHTMLContainer.style.height="100%";if(src.length===1){videoElement=document.createElement("video");videoElement.id=videoID;node.appendChild(videoElement);setTimeout(function(){var decodeDiv=document.createElement("div");decodeDiv.innerHTML=src[0];videoElement.src=decodeDiv.firstChild.nodeValue},0);return Popcorn("#"+videoID,options)}node.appendChild(videoHTMLContainer);videoHTML='<video id="'+videoID+'" preload=auto autobuffer>';for(i=0,srcLength=src.length;i<srcLength;i++){videoHTML+='<source src="'+src[i]+'">'}videoHTML+="</video>";videoHTMLContainer.innerHTML=videoHTML;if(options&&options.events&&options.events.error){node.addEventListener("error",options.events.error,false)}return Popcorn("#"+videoID,options)}})(Popcorn);(function(window,Popcorn){var canPlayType=function(nodeName,url){return typeof url==="string"&&Popcorn.HTMLYouTubeVideoElement._canPlaySrc(url)};Popcorn.player("youtube",{_canPlayType:canPlayType});Popcorn.youtube=function(container,url,options){if(typeof console!=="undefined"&&console.warn){console.warn("Deprecated player 'youtube'. Please use Popcorn.HTMLYouTubeVideoElement directly.")}var media=Popcorn.HTMLYouTubeVideoElement(container),popcorn=Popcorn(media,options);setTimeout(function(){media.src=url},0);return popcorn};Popcorn.youtube.canPlayType=canPlayType})(window,Popcorn);(function(Popcorn,document){function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var _fakeTimeRanges={length:0,start:Popcorn.nop,end:Popcorn.nop};window.MediaError=window.MediaError||function(){function MediaError(code,msg){this.code=code||null;this.message=msg||""}MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;
MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;return MediaError}();function MediaElementProto(){var protoElement={},events={},parentNode;if(!Object.prototype.__defineGetter__){protoElement=document.createElement("div")}protoElement._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(value){return typeof value==="string"||value===true},parseUri:parseUri};protoElement.addEventListener=function(type,listener,useCapture){document.addEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.removeEventListener=function(type,listener,useCapture){document.removeEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.dispatchEvent=function(name){var customEvent=document.createEvent("CustomEvent"),detail={type:name,target:this.parentNode,data:null};customEvent.initCustomEvent(this._eventNamespace+name,false,false,detail);document.dispatchEvent(customEvent)};protoElement.load=Popcorn.nop;protoElement.canPlayType=function(url){return""};protoElement.getBoundingClientRect=function(){return parentNode.getBoundingClientRect()};protoElement.NETWORK_EMPTY=0;protoElement.NETWORK_IDLE=1;protoElement.NETWORK_LOADING=2;protoElement.NETWORK_NO_SOURCE=3;protoElement.HAVE_NOTHING=0;protoElement.HAVE_METADATA=1;protoElement.HAVE_CURRENT_DATA=2;protoElement.HAVE_FUTURE_DATA=3;protoElement.HAVE_ENOUGH_DATA=4;Object.defineProperties(protoElement,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:true},parentNode:{get:function(){return parentNode},set:function(val){parentNode=val},configurable:true},preload:{get:function(){return"auto"},set:Popcorn.nop,configurable:true},controls:{get:function(){return true},set:Popcorn.nop,configurable:true},poster:{get:function(){return""},set:Popcorn.nop,configurable:true},crossorigin:{get:function(){return""},configurable:true},played:{get:function(){return _fakeTimeRanges},configurable:true},seekable:{get:function(){return _fakeTimeRanges},configurable:true},buffered:{get:function(){return _fakeTimeRanges},configurable:true},defaultMuted:{get:function(){return false},configurable:true},defaultPlaybackRate:{get:function(){return 1},configurable:true},style:{get:function(){return this.parentNode.style},configurable:true},id:{get:function(){return this.parentNode.id},configurable:true}});return protoElement}Popcorn._MediaElementProto=MediaElementProto})(Popcorn,window.document);(function(Popcorn,document){function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var _fakeTimeRanges={length:0,start:Popcorn.nop,end:Popcorn.nop};window.MediaError=window.MediaError||function(){function MediaError(code,msg){this.code=code||null;this.message=msg||""}MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;return MediaError}();function MediaElementProto(){var protoElement={},events={},parentNode;if(!Object.prototype.__defineGetter__){protoElement=document.createElement("div")}protoElement._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(value){return typeof value==="string"||value===true},parseUri:parseUri};protoElement.addEventListener=function(type,listener,useCapture){document.addEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.removeEventListener=function(type,listener,useCapture){document.removeEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.dispatchEvent=function(name){var customEvent=document.createEvent("CustomEvent"),detail={type:name,target:this.parentNode,data:null};customEvent.initCustomEvent(this._eventNamespace+name,false,false,detail);document.dispatchEvent(customEvent)};protoElement.load=Popcorn.nop;protoElement.canPlayType=function(url){return""};protoElement.getBoundingClientRect=function(){return parentNode.getBoundingClientRect()};protoElement.NETWORK_EMPTY=0;protoElement.NETWORK_IDLE=1;protoElement.NETWORK_LOADING=2;protoElement.NETWORK_NO_SOURCE=3;protoElement.HAVE_NOTHING=0;protoElement.HAVE_METADATA=1;protoElement.HAVE_CURRENT_DATA=2;protoElement.HAVE_FUTURE_DATA=3;protoElement.HAVE_ENOUGH_DATA=4;Object.defineProperties(protoElement,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:true},parentNode:{get:function(){return parentNode},set:function(val){parentNode=val},configurable:true},preload:{get:function(){return"auto"},set:Popcorn.nop,configurable:true},controls:{get:function(){return true},set:Popcorn.nop,configurable:true},poster:{get:function(){return""},set:Popcorn.nop,configurable:true},crossorigin:{get:function(){return""},configurable:true},played:{get:function(){return _fakeTimeRanges},configurable:true},seekable:{get:function(){return _fakeTimeRanges},configurable:true},buffered:{get:function(){return _fakeTimeRanges},configurable:true},defaultMuted:{get:function(){return false},configurable:true},defaultPlaybackRate:{get:function(){return 1},configurable:true},style:{get:function(){return this.parentNode.style},configurable:true},id:{get:function(){return this.parentNode.id},configurable:true}});return protoElement}Popcorn._MediaElementProto=MediaElementProto})(Popcorn,window.document);(function(Popcorn,document){function canPlaySrc(src){return"maybe"}function wrapMedia(id,mediaType){var parent=typeof id==="string"?document.querySelector(id):id,media=document.createElement(mediaType);parent.appendChild(media);media._canPlaySrc=canPlaySrc;return media}Popcorn.HTMLVideoElement=function(id){return wrapMedia(id,"video")};Popcorn.HTMLVideoElement._canPlaySrc=canPlaySrc;Popcorn.HTMLAudioElement=function(id){return wrapMedia(id,"audio")};Popcorn.HTMLAudioElement._canPlaySrc=canPlaySrc})(Popcorn,window.document);(function(Popcorn,document){function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var _fakeTimeRanges={length:0,start:Popcorn.nop,end:Popcorn.nop};window.MediaError=window.MediaError||function(){function MediaError(code,msg){this.code=code||null;this.message=msg||""}MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;return MediaError}();function MediaElementProto(){var protoElement={},events={},parentNode;if(!Object.prototype.__defineGetter__){protoElement=document.createElement("div")}protoElement._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(value){return typeof value==="string"||value===true},parseUri:parseUri};protoElement.addEventListener=function(type,listener,useCapture){document.addEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.removeEventListener=function(type,listener,useCapture){document.removeEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.dispatchEvent=function(name){var customEvent=document.createEvent("CustomEvent"),detail={type:name,target:this.parentNode,data:null};customEvent.initCustomEvent(this._eventNamespace+name,false,false,detail);document.dispatchEvent(customEvent)};protoElement.load=Popcorn.nop;protoElement.canPlayType=function(url){return""};protoElement.getBoundingClientRect=function(){return parentNode.getBoundingClientRect()};protoElement.NETWORK_EMPTY=0;protoElement.NETWORK_IDLE=1;protoElement.NETWORK_LOADING=2;protoElement.NETWORK_NO_SOURCE=3;protoElement.HAVE_NOTHING=0;protoElement.HAVE_METADATA=1;protoElement.HAVE_CURRENT_DATA=2;protoElement.HAVE_FUTURE_DATA=3;protoElement.HAVE_ENOUGH_DATA=4;Object.defineProperties(protoElement,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:true},parentNode:{get:function(){return parentNode},set:function(val){parentNode=val},configurable:true},preload:{get:function(){return"auto"},set:Popcorn.nop,configurable:true},controls:{get:function(){return true},set:Popcorn.nop,configurable:true},poster:{get:function(){return""},set:Popcorn.nop,configurable:true},crossorigin:{get:function(){return""},configurable:true},played:{get:function(){return _fakeTimeRanges},configurable:true},seekable:{get:function(){return _fakeTimeRanges},configurable:true},buffered:{get:function(){return _fakeTimeRanges},configurable:true},defaultMuted:{get:function(){return false},configurable:true},defaultPlaybackRate:{get:function(){return 1},configurable:true},style:{get:function(){return this.parentNode.style},configurable:true},id:{get:function(){return this.parentNode.id},configurable:true}});return protoElement}Popcorn._MediaElementProto=MediaElementProto})(Popcorn,window.document);(function(Popcorn,document){var DEFAULT_UPDATE_RESOLUTION_MS=16,DEFAULT_UPDATE_RESOLUTION_S=DEFAULT_UPDATE_RESOLUTION_MS/1e3,EMPTY_STRING="",temporalRegex=/#t=(\d+\.?\d*)?,?(\d+\.?\d*)/;function NullPlayer(options){this.startTime=0;this.currentTime=options.currentTime||0;this.duration=options.duration||NaN;this.playInterval=null;this.paused=true;this.defaultPlaybackRate=1;this.playbackRate=1;this.ended=options.endedCallback||Popcorn.nop}function nullPlay(video){video.currentTime+=(Date.now()-video.startTime)/(1e3/video.playbackRate);video.startTime=Date.now();if(video.currentTime>=video.duration){video.pause(video.duration);video.ended()}if(video.currentTime<0){video.pause(0)}}NullPlayer.prototype={play:function(){var video=this;if(this.paused){this.paused=false;this.startTime=Date.now();this.playInterval=setInterval(function(){nullPlay(video)},DEFAULT_UPDATE_RESOLUTION_MS)}},pause:function(){if(!this.paused){this.paused=true;clearInterval(this.playInterval)}},seekTo:function(aTime){aTime=aTime<0?0:aTime;aTime=aTime>this.duration?this.duration:aTime;this.currentTime=aTime}};function HTMLNullVideoElement(id){var self=new Popcorn._MediaElementProto,parent=typeof id==="string"?document.querySelector(id):id,elem=document.createElement("div"),playerReady=false,player,impl={src:EMPTY_STRING,networkState:self.NETWORK_EMPTY,readyState:self.HAVE_NOTHING,autoplay:EMPTY_STRING,preload:EMPTY_STRING,controls:EMPTY_STRING,loop:false,poster:EMPTY_STRING,volume:1,muted:false,width:parent.width|0?parent.width:self._util.MIN_WIDTH,height:parent.height|0?parent.height:self._util.MIN_HEIGHT,seeking:false,ended:false,paused:1,error:null},playerReadyCallbacks=[],timeUpdateInterval;self._eventNamespace=Popcorn.guid("HTMLNullVideoElement::");self.parentNode=parent;self._util.type="NullVideo";function addPlayerReadyCallback(callback){playerReadyCallbacks.push(callback)}function onPlayerReady(){var callback;playerReady=true;impl.networkState=self.NETWORK_IDLE;impl.readyState=self.HAVE_METADATA;self.dispatchEvent("loadedmetadata");self.dispatchEvent("loadeddata");impl.readyState=self.HAVE_FUTURE_DATA;self.dispatchEvent("canplay");impl.readyState=self.HAVE_ENOUGH_DATA;self.dispatchEvent("canplaythrough");while(playerReadyCallbacks.length){callback=playerReadyCallbacks.shift();callback()}if(impl.autoplay){self.play()}}function getDuration(){return player?player.duration:NaN}function destroyPlayer(){if(!(playerReady&&player)){return}player.pause();player=null;parent.removeChild(elem);elem=document.createElement("div")}function changeSrc(aSrc){if(!self._canPlaySrc(aSrc)){impl.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED};self.dispatchEvent("error");return}impl.src=aSrc;if(playerReady){destroyPlayer()}elem.width=impl.width;elem.height=impl.height;parent.appendChild(elem);var fragments=temporalRegex.exec(aSrc),start=+fragments[1],duration=+fragments[2];player=new NullPlayer({currentTime:start,duration:duration,endedCallback:onEnded});self.dispatchEvent("loadstart");self.dispatchEvent("progress");self.dispatchEvent("durationchange");onPlayerReady()}function getCurrentTime(){if(!playerReady){return 0}return player.currentTime}function changeCurrentTime(aTime){if(aTime===getCurrentTime()){return}if(!playerReady){addPlayerReadyCallback(function(){changeCurrentTime(aTime)});return}onSeeking();player.seekTo(aTime);onSeeked()}function onTimeUpdate(){self.dispatchEvent("timeupdate")}function onSeeking(target){impl.seeking=true;self.dispatchEvent("seeking")}function onSeeked(){impl.ended=false;impl.seeking=false;self.dispatchEvent("timeupdate");self.dispatchEvent("seeked");self.dispatchEvent("canplay");self.dispatchEvent("canplaythrough")}function onPlay(){if(impl.paused===1){impl.paused=false;self.dispatchEvent("play");self.dispatchEvent("playing")}else{if(impl.ended){changeCurrentTime(0);impl.ended=false}if(impl.paused){impl.paused=false;if(!impl.loop){self.dispatchEvent("play")}self.dispatchEvent("playing")}}timeUpdateInterval=setInterval(onTimeUpdate,self._util.TIMEUPDATE_MS)}self.play=function(){if(!playerReady){addPlayerReadyCallback(function(){self.play()});return}player.play();if(impl.paused){onPlay()}};function onPause(){impl.paused=true;clearInterval(timeUpdateInterval);self.dispatchEvent("pause")}self.pause=function(){if(!playerReady){addPlayerReadyCallback(function(){self.pause()});return}player.pause();if(!impl.paused){onPause()}};function onEnded(){if(impl.loop){changeCurrentTime(0);self.play()}else{impl.ended=true;onPause();self.dispatchEvent("timeupdate");self.dispatchEvent("ended")}}function setVolume(aValue){impl.volume=aValue;self.dispatchEvent("volumechange")}function getVolume(){return impl.volume}function setMuted(aValue){impl.muted=aValue;self.dispatchEvent("volumechange")}function getMuted(){return impl.muted}Object.defineProperties(self,{src:{get:function(){return impl.src},set:function(aSrc){if(aSrc&&aSrc!==impl.src){changeSrc(aSrc)}}},autoplay:{get:function(){return impl.autoplay},set:function(aValue){impl.autoplay=self._util.isAttributeSet(aValue)}},loop:{get:function(){return impl.loop},set:function(aValue){impl.loop=self._util.isAttributeSet(aValue)}},width:{get:function(){return elem.width},set:function(aValue){elem.width=aValue;impl.width=elem.width}},height:{get:function(){return elem.height},set:function(aValue){elem.height=aValue;impl.height=elem.height}},currentTime:{get:function(){return getCurrentTime()},set:function(aValue){changeCurrentTime(aValue)}},duration:{get:function(){return getDuration()}},ended:{get:function(){return impl.ended}},paused:{get:function(){return impl.paused}},seeking:{get:function(){return impl.seeking}},readyState:{get:function(){return impl.readyState}},networkState:{get:function(){return impl.networkState}},volume:{get:function(){return getVolume()},set:function(aValue){if(aValue<0||aValue>1){throw"Volume value must be between 0.0 and 1.0"}setVolume(aValue)}},muted:{get:function(){return getMuted()},set:function(aValue){setMuted(self._util.isAttributeSet(aValue))}},playbackRate:{get:function(){return player.playbackRate},set:function(aValue){player.playbackRate=aValue;self.dispatchEvent("ratechange")}},error:{get:function(){return impl.error}}});self._canPlaySrc=Popcorn.HTMLNullVideoElement._canPlaySrc;self.canPlayType=Popcorn.HTMLNullVideoElement.canPlayType;return self}Popcorn.HTMLNullVideoElement=function(id){return new HTMLNullVideoElement(id)};Popcorn.HTMLNullVideoElement._canPlaySrc=function(url){return temporalRegex.test(url)?"probably":EMPTY_STRING};Popcorn.HTMLNullVideoElement.canPlayType=function(type){return type==="video/x-nullvideo"?"probably":EMPTY_STRING}})(Popcorn,document);(function(Popcorn,document){function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var _fakeTimeRanges={length:0,start:Popcorn.nop,end:Popcorn.nop};window.MediaError=window.MediaError||function(){function MediaError(code,msg){this.code=code||null;this.message=msg||""}MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;return MediaError}();function MediaElementProto(){var protoElement={},events={},parentNode;if(!Object.prototype.__defineGetter__){protoElement=document.createElement("div")}protoElement._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(value){return typeof value==="string"||value===true},parseUri:parseUri};protoElement.addEventListener=function(type,listener,useCapture){document.addEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.removeEventListener=function(type,listener,useCapture){document.removeEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.dispatchEvent=function(name){var customEvent=document.createEvent("CustomEvent"),detail={type:name,target:this.parentNode,data:null};customEvent.initCustomEvent(this._eventNamespace+name,false,false,detail);document.dispatchEvent(customEvent)};protoElement.load=Popcorn.nop;protoElement.canPlayType=function(url){return""};protoElement.getBoundingClientRect=function(){return parentNode.getBoundingClientRect()};protoElement.NETWORK_EMPTY=0;protoElement.NETWORK_IDLE=1;protoElement.NETWORK_LOADING=2;protoElement.NETWORK_NO_SOURCE=3;protoElement.HAVE_NOTHING=0;protoElement.HAVE_METADATA=1;protoElement.HAVE_CURRENT_DATA=2;protoElement.HAVE_FUTURE_DATA=3;protoElement.HAVE_ENOUGH_DATA=4;Object.defineProperties(protoElement,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:true},parentNode:{get:function(){return parentNode},set:function(val){parentNode=val},configurable:true},preload:{get:function(){return"auto"},set:Popcorn.nop,configurable:true},controls:{get:function(){return true},set:Popcorn.nop,configurable:true},poster:{get:function(){return""},set:Popcorn.nop,configurable:true},crossorigin:{get:function(){return""},configurable:true},played:{get:function(){return _fakeTimeRanges},configurable:true},seekable:{get:function(){return _fakeTimeRanges},configurable:true},buffered:{get:function(){return _fakeTimeRanges},configurable:true},defaultMuted:{get:function(){return false},configurable:true},defaultPlaybackRate:{get:function(){return 1},configurable:true},style:{get:function(){return this.parentNode.style},configurable:true},id:{get:function(){return this.parentNode.id},configurable:true}});return protoElement}Popcorn._MediaElementProto=MediaElementProto})(Popcorn,window.document);(function(Popcorn,window,document){var CURRENT_TIME_MONITOR_MS=16,EMPTY_STRING="",scReady=false,scLoaded=false,scCallbacks=[];function isSoundCloudReady(){if(!scLoaded){Popcorn.getScript("https://w.soundcloud.com/player/api.js",function(){Popcorn.getScript("https://connect.soundcloud.com/sdk.js",function(){scReady=true;SC.initialize({client_id:"PRaNFlda6Bhf5utPjUsptg"});var i=scCallbacks.length;while(i--){scCallbacks[i]();delete scCallbacks[i]}})});scLoaded=true}return scReady}function addSoundCloudCallback(callback){scCallbacks.unshift(callback)}function HTMLSoundCloudAudioElement(id){if(!window.postMessage){throw"ERROR: HTMLSoundCloudAudioElement requires window.postMessage"}var self=new Popcorn._MediaElementProto,parent=typeof id==="string"?Popcorn.dom.find(id):id,elem=document.createElement("iframe"),impl={src:EMPTY_STRING,networkState:self.NETWORK_EMPTY,readyState:self.HAVE_NOTHING,seeking:false,autoplay:EMPTY_STRING,preload:EMPTY_STRING,controls:false,loop:false,poster:EMPTY_STRING,volume:100,muted:0,currentTime:0,duration:NaN,ended:false,paused:true,width:parent.width|0?parent.width:self._util.MIN_WIDTH,height:parent.height|0?parent.height:self._util.MIN_HEIGHT,error:null},playerReady=false,playerPaused=true,player,playerReadyCallbacks=[],timeUpdateInterval,currentTimeInterval,lastCurrentTime=0;self._eventNamespace=Popcorn.guid("HTMLSoundCloudAudioElement::");self.parentNode=parent;self._util.type="SoundCloud";function addPlayerReadyCallback(callback){playerReadyCallbacks.unshift(callback)}function onLoaded(){player.bind(SC.Widget.Events.LOAD_PROGRESS,function(data){onStateChange({type:"loadProgress",data:data.currentPosition/1e3})});player.bind(SC.Widget.Events.PLAY_PROGRESS,function(data){onStateChange({type:"playProgress",data:data.currentPosition/1e3})});player.bind(SC.Widget.Events.PLAY,function(data){onStateChange({type:"play"})});player.bind(SC.Widget.Events.PAUSE,function(data){onStateChange({type:"pause"})});player.bind(SC.Widget.Events.SEEK,function(data){player.getPosition(function(currentTimeInMS){var currentTimeInSeconds=currentTimeInMS/1e3;if(impl.seeking){if(Math.floor(currentTimeInSeconds)!==Math.floor(impl.currentTime)){player.seekTo(impl.currentTime*1e3)}else{onSeeked()}return}onStateChange({type:"seek",data:currentTimeInSeconds})})});player.bind(SC.Widget.Events.FINISH,function(){onStateChange({type:"finish"})});playerReady=true;player.getDuration(updateDuration)}function onPlayerReady(data){player.bind(SC.Widget.Events.PLAY_PROGRESS,function(data){player.setVolume(0);if(data.currentPosition>0){player.unbind(SC.Widget.Events.PLAY_PROGRESS);player.bind(SC.Widget.Events.PAUSE,function(){player.unbind(SC.Widget.Events.PAUSE);player.setVolume(100);player.bind(SC.Widget.Events.SEEK,function(){player.unbind(SC.Widget.Events.SEEK);onLoaded()});player.seekTo(0)});player.pause()}});player.play()}function updateDuration(newDuration){newDuration=newDuration/1e3;var oldDuration=impl.duration;if(oldDuration!==newDuration){impl.duration=newDuration;self.dispatchEvent("durationchange");if(isNaN(oldDuration)){impl.networkState=self.NETWORK_IDLE;impl.readyState=self.HAVE_METADATA;self.dispatchEvent("loadedmetadata");self.dispatchEvent("loadeddata");impl.readyState=self.HAVE_FUTURE_DATA;self.dispatchEvent("canplay");impl.readyState=self.HAVE_ENOUGH_DATA;self.dispatchEvent("canplaythrough");var i=playerReadyCallbacks.length;while(i--){playerReadyCallbacks[i]();delete playerReadyCallbacks[i]}if(impl.paused&&impl.autoplay){self.play()}}}}function getDuration(){if(!playerReady){addPlayerReadyCallback(function(){getDuration()})}player.getDuration(updateDuration)}function destroyPlayer(){if(!(playerReady&&player)){return}clearInterval(currentTimeInterval);player.pause();player.unbind(SC.Widget.Events.READY);player.unbind(SC.Widget.Events.LOAD_PROGRESS);player.unbind(SC.Widget.Events.PLAY_PROGRESS);player.unbind(SC.Widget.Events.PLAY);player.unbind(SC.Widget.Events.PAUSE);player.unbind(SC.Widget.Events.SEEK);player.unbind(SC.Widget.Events.FINISH);parent.removeChild(elem);elem=document.createElement("iframe")}self.play=function(){impl.paused=false;if(!playerReady){addPlayerReadyCallback(function(){self.play()});return}if(impl.ended){changeCurrentTime(0)}player.play()};function changeCurrentTime(aTime){impl.currentTime=aTime;aTime=aTime*1e3;function seek(){onSeeking();player.seekTo(aTime)}if(!playerReady){addMediaReadyCallback(seek);return}seek()}function onSeeking(){impl.seeking=true;self.dispatchEvent("seeking")}function onSeeked(){impl.ended=false;impl.seeking=false;self.dispatchEvent("timeupdate");self.dispatchEvent("seeked");self.dispatchEvent("canplay");self.dispatchEvent("canplaythrough")}self.pause=function(){impl.paused=true;if(!playerReady){addPlayerReadyCallback(function(){self.pause()});return}player.pause()};function onPause(){impl.paused=true;if(!playerPaused){playerPaused=true;clearInterval(timeUpdateInterval);self.dispatchEvent("pause")}}function onTimeUpdate(){self.dispatchEvent("timeupdate")}function onPlay(){if(!currentTimeInterval){currentTimeInterval=setInterval(monitorCurrentTime,CURRENT_TIME_MONITOR_MS);if(impl.loop){self.dispatchEvent("play")}}timeUpdateInterval=setInterval(onTimeUpdate,self._util.TIMEUPDATE_MS);impl.paused=false;if(playerPaused){playerPaused=false;if(!impl.loop){self.dispatchEvent("play")}self.dispatchEvent("playing")}}function onEnded(){if(impl.loop){changeCurrentTime(0);self.play()}else{impl.ended=true;self.pause();onPause();self.dispatchEvent("timeupdate");self.dispatchEvent("ended")}}function onCurrentTime(currentTime){impl.currentTime=currentTime;if(currentTime!==lastCurrentTime){self.dispatchEvent("timeupdate")}lastCurrentTime=currentTime}function onStateChange(event){switch(event.type){case"loadProgress":self.dispatchEvent("progress");break;case"playProgress":onCurrentTime(event.data);break;case"play":onPlay();break;case"pause":onPause();break;case"finish":onEnded();break;case"seek":onCurrentTime(event.data);break}}function monitorCurrentTime(){if(impl.ended){return}player.getPosition(function(currentTimeInMS){onCurrentTime(currentTimeInMS/1e3)})}function changeSrc(aSrc){if(!self._canPlaySrc(aSrc)){impl.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED};self.dispatchEvent("error");return}impl.src=aSrc;if(playerReady){destroyPlayer()}if(!isSoundCloudReady()){addSoundCloudCallback(function(){changeSrc(aSrc)});return}playerReady=false;SC.get("/resolve",{url:aSrc},function(data){var err;if(data.errors){err={name:"MediaError"};if(data.errors[0]){if(data.errors[0].error_message==="404 - Not Found"){err.message="Video not found.";err.code=MediaError.MEDIA_ERR_NETWORK}}impl.error=err;self.dispatchEvent("error")}elem.id=Popcorn.guid("soundcloud-");elem.width=impl.width;elem.height=impl.height;elem.frameBorder=0;elem.webkitAllowFullScreen=true;elem.mozAllowFullScreen=true;elem.allowFullScreen=true;setControls(impl.controls);parent.appendChild(elem);elem.onload=function(){elem.onload=null;player=SC.Widget(elem);player.bind(SC.Widget.Events.READY,onPlayerReady);impl.networkState=self.NETWORK_LOADING;self.dispatchEvent("loadstart");self.dispatchEvent("progress")};elem.src="https://w.soundcloud.com/player/?url="+data.uri+"&show_artwork=false"+"&buying=false"+"&liking=false"+"&sharing=false"+"&download=false"+"&show_comments=false"+"&show_user=false"+"&single_active=false"})}function setVolume(aValue){impl.volume=aValue;if(!playerReady){addPlayerReadyCallback(function(){setVolume(aValue)});return}player.setVolume(aValue);self.dispatchEvent("volumechange")}function getVolume(){return impl.muted>0?impl.muted:impl.volume}function setMuted(aMute){if(!playerReady){impl.muted=aMute?1:0;addPlayerReadyCallback(function(){setMuted(aMute)});return}if(aMute){impl.muted=impl.volume;setVolume(0)}else{impl.muted=0;setVolume(impl.muted)}}function getMuted(){return impl.muted>0}function setControls(controls){if(playerReady){elem.style.position="absolute";elem.style.visibility=controls?"visible":"hidden"}else{elem.style.opacity=controls?"1":"0";elem.style.pointerEvents=controls?"auto":"none"}impl.controls=controls}Object.defineProperties(self,{src:{get:function(){return impl.src},set:function(aSrc){if(aSrc&&aSrc!==impl.src){changeSrc(aSrc)}}},autoplay:{get:function(){return impl.autoplay},set:function(aValue){impl.autoplay=self._util.isAttributeSet(aValue)}},loop:{get:function(){return impl.loop},set:function(aValue){impl.loop=self._util.isAttributeSet(aValue)}},width:{get:function(){return elem.width},set:function(aValue){elem.width=aValue;impl.width=elem.width}},height:{get:function(){return elem.height},set:function(aValue){elem.height=aValue;impl.height=elem.height}},currentTime:{get:function(){return impl.currentTime},set:function(aValue){changeCurrentTime(aValue)}},duration:{get:function(){return impl.duration}},ended:{get:function(){return impl.ended}},paused:{get:function(){return impl.paused}},seeking:{get:function(){return impl.seeking}},readyState:{get:function(){return impl.readyState}},networkState:{get:function(){return impl.networkState}},volume:{get:function(){var volume=getVolume();return volume/100},set:function(aValue){if(aValue<0||aValue>1){throw"Volume value must be between 0.0 and 1.0"}aValue=aValue*100;setVolume(aValue)}},muted:{get:function(){return getMuted()},set:function(aValue){setMuted(self._util.isAttributeSet(aValue))}},error:{get:function(){return impl.error}},controls:{get:function(){return impl.controls},set:function(aValue){setControls(!!aValue)}}});self._canPlaySrc=Popcorn.HTMLSoundCloudAudioElement._canPlaySrc;self.canPlayType=Popcorn.HTMLSoundCloudAudioElement.canPlayType;return self}Popcorn.HTMLSoundCloudAudioElement=function(id){return new HTMLSoundCloudAudioElement(id)};Popcorn.HTMLSoundCloudAudioElement._canPlaySrc=function(url){return/(?:https?:\/\/www\.|https?:\/\/|www\.|\.|^)(soundcloud)/.test(url)?"probably":EMPTY_STRING};Popcorn.HTMLSoundCloudAudioElement.canPlayType=function(type){return type==="audio/x-soundcloud"?"probably":EMPTY_STRING}})(Popcorn,window,document);(function(Popcorn,document){function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var _fakeTimeRanges={length:0,start:Popcorn.nop,end:Popcorn.nop};window.MediaError=window.MediaError||function(){function MediaError(code,msg){this.code=code||null;this.message=msg||""}MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;return MediaError}();function MediaElementProto(){var protoElement={},events={},parentNode;if(!Object.prototype.__defineGetter__){protoElement=document.createElement("div")}protoElement._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(value){return typeof value==="string"||value===true
},parseUri:parseUri};protoElement.addEventListener=function(type,listener,useCapture){document.addEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.removeEventListener=function(type,listener,useCapture){document.removeEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.dispatchEvent=function(name){var customEvent=document.createEvent("CustomEvent"),detail={type:name,target:this.parentNode,data:null};customEvent.initCustomEvent(this._eventNamespace+name,false,false,detail);document.dispatchEvent(customEvent)};protoElement.load=Popcorn.nop;protoElement.canPlayType=function(url){return""};protoElement.getBoundingClientRect=function(){return parentNode.getBoundingClientRect()};protoElement.NETWORK_EMPTY=0;protoElement.NETWORK_IDLE=1;protoElement.NETWORK_LOADING=2;protoElement.NETWORK_NO_SOURCE=3;protoElement.HAVE_NOTHING=0;protoElement.HAVE_METADATA=1;protoElement.HAVE_CURRENT_DATA=2;protoElement.HAVE_FUTURE_DATA=3;protoElement.HAVE_ENOUGH_DATA=4;Object.defineProperties(protoElement,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:true},parentNode:{get:function(){return parentNode},set:function(val){parentNode=val},configurable:true},preload:{get:function(){return"auto"},set:Popcorn.nop,configurable:true},controls:{get:function(){return true},set:Popcorn.nop,configurable:true},poster:{get:function(){return""},set:Popcorn.nop,configurable:true},crossorigin:{get:function(){return""},configurable:true},played:{get:function(){return _fakeTimeRanges},configurable:true},seekable:{get:function(){return _fakeTimeRanges},configurable:true},buffered:{get:function(){return _fakeTimeRanges},configurable:true},defaultMuted:{get:function(){return false},configurable:true},defaultPlaybackRate:{get:function(){return 1},configurable:true},style:{get:function(){return this.parentNode.style},configurable:true},id:{get:function(){return this.parentNode.id},configurable:true}});return protoElement}Popcorn._MediaElementProto=MediaElementProto})(Popcorn,window.document);(function(Popcorn,window,document){var CURRENT_TIME_MONITOR_MS=16,EMPTY_STRING="",VIMEO_HOST="https://player.vimeo.com";function VimeoPlayer(vimeoIFrame){var self=this,url=vimeoIFrame.src.split("?")[0],muted=0;if(url.substr(0,2)==="//"){url=window.location.protocol+url}function sendMessage(method,params){var data=JSON.stringify({method:method,value:params});if(!vimeoIFrame.contentWindow){return}vimeoIFrame.contentWindow.postMessage(data,url)}var methods=("play pause paused seekTo unload getCurrentTime getDuration "+"getVideoEmbedCode getVideoHeight getVideoWidth getVideoUrl "+"getColor setColor setLoop getVolume setVolume addEventListener").split(" ");methods.forEach(function(method){self[method]=function(arg0){sendMessage(method,arg0)}})}function HTMLVimeoVideoElement(id){if(!window.postMessage){throw"ERROR: HTMLVimeoVideoElement requires window.postMessage"}var self=new Popcorn._MediaElementProto,parent=typeof id==="string"?Popcorn.dom.find(id):id,elem=document.createElement("iframe"),impl={src:EMPTY_STRING,networkState:self.NETWORK_EMPTY,readyState:self.HAVE_NOTHING,seeking:false,autoplay:EMPTY_STRING,preload:EMPTY_STRING,controls:false,loop:false,poster:EMPTY_STRING,volume:1,muted:0,currentTime:0,duration:NaN,ended:false,paused:true,error:null},playerReady=false,playerUID=Popcorn.guid(),player,playerPaused=true,playerReadyCallbacks=[],timeUpdateInterval,currentTimeInterval,lastCurrentTime=0;self._eventNamespace=Popcorn.guid("HTMLVimeoVideoElement::");self.parentNode=parent;self._util.type="Vimeo";function addPlayerReadyCallback(callback){playerReadyCallbacks.unshift(callback)}function onPlayerReady(event){player.addEventListener("loadProgress");player.addEventListener("playProgress");player.addEventListener("play");player.addEventListener("pause");player.addEventListener("finish");player.addEventListener("seek");player.getDuration();impl.networkState=self.NETWORK_LOADING;self.dispatchEvent("loadstart");self.dispatchEvent("progress")}function updateDuration(newDuration){var oldDuration=impl.duration;if(oldDuration!==newDuration){impl.duration=newDuration;self.dispatchEvent("durationchange");if(isNaN(oldDuration)){impl.networkState=self.NETWORK_IDLE;impl.readyState=self.HAVE_METADATA;self.dispatchEvent("loadedmetadata");self.dispatchEvent("loadeddata");impl.readyState=self.HAVE_FUTURE_DATA;self.dispatchEvent("canplay");impl.readyState=self.HAVE_ENOUGH_DATA;self.dispatchEvent("canplaythrough");if(impl.autoplay){self.play()}var i=playerReadyCallbacks.length;while(i--){playerReadyCallbacks[i]();delete playerReadyCallbacks[i]}}}}function getDuration(){if(!playerReady){addPlayerReadyCallback(function(){getDuration()})}player.getDuration()}function destroyPlayer(){if(!(playerReady&&player)){return}clearInterval(currentTimeInterval);player.pause();window.removeEventListener("message",onStateChange,false);parent.removeChild(elem);elem=document.createElement("iframe")}self.play=function(){impl.paused=false;if(!playerReady){addPlayerReadyCallback(function(){self.play()});return}player.play()};function changeCurrentTime(aTime){if(!playerReady){addPlayerReadyCallback(function(){changeCurrentTime(aTime)});return}onSeeking();player.seekTo(aTime)}function onSeeking(){impl.seeking=true;self.dispatchEvent("seeking")}function onSeeked(){impl.seeking=false;self.dispatchEvent("timeupdate");self.dispatchEvent("seeked");self.dispatchEvent("canplay");self.dispatchEvent("canplaythrough")}self.pause=function(){impl.paused=true;if(!playerReady){addPlayerReadyCallback(function(){self.pause()});return}player.pause()};function onPause(){impl.paused=true;if(!playerPaused){playerPaused=true;clearInterval(timeUpdateInterval);self.dispatchEvent("pause")}}function onTimeUpdate(){self.dispatchEvent("timeupdate")}function onPlay(){if(impl.ended){changeCurrentTime(0)}if(!currentTimeInterval){currentTimeInterval=setInterval(monitorCurrentTime,CURRENT_TIME_MONITOR_MS);if(impl.loop){self.dispatchEvent("play")}}timeUpdateInterval=setInterval(onTimeUpdate,self._util.TIMEUPDATE_MS);impl.paused=false;if(playerPaused){playerPaused=false;if(!impl.loop){self.dispatchEvent("play")}self.dispatchEvent("playing")}}function onEnded(){if(impl.loop){changeCurrentTime(0);self.play()}else{impl.ended=true;self.dispatchEvent("ended")}}function onCurrentTime(aTime){var currentTime=impl.currentTime=aTime;if(currentTime!==lastCurrentTime){self.dispatchEvent("timeupdate")}lastCurrentTime=impl.currentTime}function startupMessage(event){if(event.origin!==VIMEO_HOST){return}var data;try{data=JSON.parse(event.data)}catch(ex){console.warn(ex)}if(data.player_id!=playerUID){return}switch(data.event){case"ready":player=new VimeoPlayer(elem);player.addEventListener("loadProgress");player.addEventListener("pause");player.setVolume(0);player.play();break;case"loadProgress":var duration=parseFloat(data.data.duration);if(duration>0&&!playerReady){playerReady=true;player.pause()}break;case"pause":player.setVolume(1);window.removeEventListener("message",startupMessage,false);window.addEventListener("message",onStateChange,false);onPlayerReady();break}}function onStateChange(event){if(event.origin!==VIMEO_HOST){return}var data;try{data=JSON.parse(event.data)}catch(ex){console.warn(ex)}if(data.player_id!=playerUID){return}switch(data.method){case"getCurrentTime":onCurrentTime(parseFloat(data.value));break;case"getDuration":updateDuration(parseFloat(data.value));break;case"getVolume":onVolume(parseFloat(data.value));break}switch(data.event){case"loadProgress":self.dispatchEvent("progress");updateDuration(parseFloat(data.data.duration));break;case"playProgress":onCurrentTime(parseFloat(data.data.seconds));break;case"play":onPlay();break;case"pause":onPause();break;case"finish":onEnded();break;case"seek":onCurrentTime(parseFloat(data.data.seconds));onSeeked();break}}function monitorCurrentTime(){player.getCurrentTime()}function changeSrc(aSrc){if(!self._canPlaySrc(aSrc)){impl.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED};self.dispatchEvent("error");return}impl.src=aSrc;if(playerReady){destroyPlayer()}playerReady=false;var src=self._util.parseUri(aSrc),queryKey=src.queryKey,key,optionsArray=["api=1","player_id="+playerUID,"title=0","byline=0","portrait=0"];impl.loop=queryKey.loop==="1"||impl.loop;delete queryKey.loop;impl.autoplay=queryKey.autoplay==="1"||impl.autoplay;delete queryKey.autoplay;src=VIMEO_HOST+"/video/"+/\d+$/.exec(src.path)+"?";for(key in queryKey){if(queryKey.hasOwnProperty(key)){optionsArray.push(encodeURIComponent(key)+"="+encodeURIComponent(queryKey[key]))}}src+=optionsArray.join("&");elem.id=playerUID;elem.style.width="100%";elem.style.height="100%";elem.frameBorder=0;elem.webkitAllowFullScreen=true;elem.mozAllowFullScreen=true;elem.allowFullScreen=true;parent.appendChild(elem);elem.src=src;window.addEventListener("message",startupMessage,false)}function onVolume(aValue){if(impl.volume!==aValue){impl.volume=aValue;self.dispatchEvent("volumechange")}}function setVolume(aValue){impl.volume=aValue;if(!playerReady){addPlayerReadyCallback(function(){setVolume(aValue)});return}player.setVolume(aValue);self.dispatchEvent("volumechange")}function getVolume(){return impl.muted>0?impl.muted:impl.volume}function setMuted(aMute){if(!playerReady){impl.muted=aMute?1:0;addPlayerReadyCallback(function(){setMuted(aMute)});return}if(aMute){impl.muted=impl.volume;setVolume(0)}else{impl.muted=0;setVolume(impl.muted)}}function getMuted(){return impl.muted>0}Object.defineProperties(self,{src:{get:function(){return impl.src},set:function(aSrc){if(aSrc&&aSrc!==impl.src){changeSrc(aSrc)}}},autoplay:{get:function(){return impl.autoplay},set:function(aValue){impl.autoplay=self._util.isAttributeSet(aValue)}},loop:{get:function(){return impl.loop},set:function(aValue){impl.loop=self._util.isAttributeSet(aValue)}},width:{get:function(){return self.parentNode.offsetWidth}},height:{get:function(){return self.parentNode.offsetHeight}},currentTime:{get:function(){return impl.currentTime},set:function(aValue){changeCurrentTime(aValue)}},duration:{get:function(){return impl.duration}},ended:{get:function(){return impl.ended}},paused:{get:function(){return impl.paused}},seeking:{get:function(){return impl.seeking}},readyState:{get:function(){return impl.readyState}},networkState:{get:function(){return impl.networkState}},volume:{get:function(){return getVolume()},set:function(aValue){if(aValue<0||aValue>1){throw"Volume value must be between 0.0 and 1.0"}setVolume(aValue)}},muted:{get:function(){return getMuted()},set:function(aValue){setMuted(self._util.isAttributeSet(aValue))}},error:{get:function(){return impl.error}}});self._canPlaySrc=Popcorn.HTMLVimeoVideoElement._canPlaySrc;self.canPlayType=Popcorn.HTMLVimeoVideoElement.canPlayType;return self}Popcorn.HTMLVimeoVideoElement=function(id){return new HTMLVimeoVideoElement(id)};Popcorn.HTMLVimeoVideoElement._canPlaySrc=function(url){return/player.vimeo.com\/video\/\d+/.test(url)||/vimeo.com\/\d+/.test(url)?"probably":EMPTY_STRING};Popcorn.HTMLVimeoVideoElement.canPlayType=function(type){return type==="video/x-vimeo"?"probably":EMPTY_STRING}})(Popcorn,window,document);(function(Popcorn,document){function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var _fakeTimeRanges={length:0,start:Popcorn.nop,end:Popcorn.nop};window.MediaError=window.MediaError||function(){function MediaError(code,msg){this.code=code||null;this.message=msg||""}MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;return MediaError}();function MediaElementProto(){var protoElement={},events={},parentNode;if(!Object.prototype.__defineGetter__){protoElement=document.createElement("div")}protoElement._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(value){return typeof value==="string"||value===true},parseUri:parseUri};protoElement.addEventListener=function(type,listener,useCapture){document.addEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.removeEventListener=function(type,listener,useCapture){document.removeEventListener(this._eventNamespace+type,listener,useCapture)};protoElement.dispatchEvent=function(name){var customEvent=document.createEvent("CustomEvent"),detail={type:name,target:this.parentNode,data:null};customEvent.initCustomEvent(this._eventNamespace+name,false,false,detail);document.dispatchEvent(customEvent)};protoElement.load=Popcorn.nop;protoElement.canPlayType=function(url){return""};protoElement.getBoundingClientRect=function(){return parentNode.getBoundingClientRect()};protoElement.NETWORK_EMPTY=0;protoElement.NETWORK_IDLE=1;protoElement.NETWORK_LOADING=2;protoElement.NETWORK_NO_SOURCE=3;protoElement.HAVE_NOTHING=0;protoElement.HAVE_METADATA=1;protoElement.HAVE_CURRENT_DATA=2;protoElement.HAVE_FUTURE_DATA=3;protoElement.HAVE_ENOUGH_DATA=4;Object.defineProperties(protoElement,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:true},parentNode:{get:function(){return parentNode},set:function(val){parentNode=val},configurable:true},preload:{get:function(){return"auto"},set:Popcorn.nop,configurable:true},controls:{get:function(){return true},set:Popcorn.nop,configurable:true},poster:{get:function(){return""},set:Popcorn.nop,configurable:true},crossorigin:{get:function(){return""},configurable:true},played:{get:function(){return _fakeTimeRanges},configurable:true},seekable:{get:function(){return _fakeTimeRanges},configurable:true},buffered:{get:function(){return _fakeTimeRanges},configurable:true},defaultMuted:{get:function(){return false},configurable:true},defaultPlaybackRate:{get:function(){return 1},configurable:true},style:{get:function(){return this.parentNode.style},configurable:true},id:{get:function(){return this.parentNode.id},configurable:true}});return protoElement}Popcorn._MediaElementProto=MediaElementProto})(Popcorn,window.document);(function(Popcorn,window,document){var CURRENT_TIME_MONITOR_MS=10,EMPTY_STRING="",regexYouTube=/^.*(?:\/|v=)(.{11})/,ABS=Math.abs,ytReady=false,ytLoading=false,ytCallbacks=[];function onYouTubeIframeAPIReady(){var callback;if(YT.loaded){ytReady=true;while(ytCallbacks.length){callback=ytCallbacks.shift();callback()}}else{setTimeout(onYouTubeIframeAPIReady,250)}}function isYouTubeReady(){var script;if(!ytLoading){if(window.YT){onYouTubeIframeAPIReady()}else{script=document.createElement("script");script.addEventListener("load",onYouTubeIframeAPIReady,false);script.src="https://www.youtube.com/iframe_api";document.head.appendChild(script)}ytLoading=true}return ytReady}function addYouTubeCallback(callback){ytCallbacks.push(callback)}function HTMLYouTubeVideoElement(id){if(!window.postMessage){throw"ERROR: HTMLYouTubeVideoElement requires window.postMessage"}var self=new Popcorn._MediaElementProto,parent=typeof id==="string"?document.querySelector(id):id,elem=document.createElement("div"),impl={src:EMPTY_STRING,networkState:self.NETWORK_EMPTY,readyState:self.HAVE_NOTHING,seeking:false,autoplay:EMPTY_STRING,preload:EMPTY_STRING,controls:false,loop:false,poster:EMPTY_STRING,volume:1,muted:false,currentTime:0,duration:NaN,ended:false,paused:true,error:null},playerReady=false,mediaReady=false,loopedPlay=false,player,playerPaused=true,mediaReadyCallbacks=[],playerState=-1,bufferedInterval,lastLoadedFraction=0,currentTimeInterval,timeUpdateInterval;self._eventNamespace=Popcorn.guid("HTMLYouTubeVideoElement::");self.parentNode=parent;self._util.type="YouTube";function addMediaReadyCallback(callback){mediaReadyCallbacks.push(callback)}function catchRoguePlayEvent(){player.pauseVideo();removeYouTubeEvent("play",catchRoguePlayEvent);addYouTubeEvent("play",onPlay)}function catchRoguePauseEvent(){addYouTubeEvent("pause",onPause);removeYouTubeEvent("pause",catchRoguePauseEvent)}function onPlayerReady(event){var onMuted=function(){if(player.isMuted()){addYouTubeEvent("play",onFirstPlay);player.playVideo()}else{setTimeout(onMuted,0)}};playerReady=true;player.mute();onMuted()}function onPlayerError(event){var err={name:"MediaError"};switch(event.data){case 2:err.message="Invalid video parameter.";err.code=MediaError.MEDIA_ERR_ABORTED;break;case 5:err.message="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.";err.code=MediaError.MEDIA_ERR_DECODE;case 100:err.message="Video not found.";err.code=MediaError.MEDIA_ERR_NETWORK;break;case 101:case 150:err.message="Video not usable.";err.code=MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED;break;default:err.message="Unknown error.";err.code=5}impl.error=err;self.dispatchEvent("error")}function onReady(){addYouTubeEvent("play",onPlay);addYouTubeEvent("pause",onPause);if(impl.autoplay||!impl.paused){removeYouTubeEvent("play",onReady);impl.paused=false;addMediaReadyCallback(function(){if(!impl.paused){onPlay()}})}if(!impl.muted){player.unMute()}impl.readyState=self.HAVE_METADATA;self.dispatchEvent("loadedmetadata");currentTimeInterval=setInterval(monitorCurrentTime,CURRENT_TIME_MONITOR_MS);self.dispatchEvent("loadeddata");impl.readyState=self.HAVE_FUTURE_DATA;self.dispatchEvent("canplay");mediaReady=true;bufferedInterval=setInterval(monitorBuffered,50);while(mediaReadyCallbacks.length){mediaReadyCallbacks[0]();mediaReadyCallbacks.shift()}impl.readyState=self.HAVE_ENOUGH_DATA;self.dispatchEvent("canplaythrough")}function onFirstPause(){removeYouTubeEvent("pause",onFirstPause);if(player.getCurrentTime()>0){setTimeout(onFirstPause,0);return}if(impl.autoplay||!impl.paused){addYouTubeEvent("play",onReady);player.playVideo()}else{onReady()}}function onFirstPlay(){removeYouTubeEvent("play",onFirstPlay);if(player.getCurrentTime()===0){setTimeout(onFirstPlay,0);return}addYouTubeEvent("pause",onFirstPause);player.seekTo(0);player.pauseVideo()}function addYouTubeEvent(event,listener){self.addEventListener("youtube-"+event,listener,false)}function removeYouTubeEvent(event,listener){self.removeEventListener("youtube-"+event,listener,false)}function dispatchYouTubeEvent(event){self.dispatchEvent("youtube-"+event)}function onBuffering(){impl.networkState=self.NETWORK_LOADING;self.dispatchEvent("waiting")}addYouTubeEvent("buffering",onBuffering);addYouTubeEvent("ended",onEnded);function onPlayerStateChange(event){switch(event.data){case YT.PlayerState.ENDED:dispatchYouTubeEvent("ended");break;case YT.PlayerState.PLAYING:dispatchYouTubeEvent("play");break;case YT.PlayerState.PAUSED:if(player.getDuration()!==player.getCurrentTime()){dispatchYouTubeEvent("pause")}break;case YT.PlayerState.BUFFERING:dispatchYouTubeEvent("buffering");break;case YT.PlayerState.CUED:break}if(event.data!==YT.PlayerState.BUFFERING&&playerState===YT.PlayerState.BUFFERING){onProgress()}playerState=event.data}function destroyPlayer(){if(!(playerReady&&player)){return}removeYouTubeEvent("buffering",onBuffering);removeYouTubeEvent("ended",onEnded);removeYouTubeEvent("play",onPlay);removeYouTubeEvent("pause",onPause);onPause();mediaReady=false;loopedPlay=false;impl.currentTime=0;mediaReadyCallbacks=[];clearInterval(currentTimeInterval);clearInterval(bufferedInterval);player.stopVideo();player.clearVideo();player.destroy();elem=document.createElement("div")}function changeSrc(aSrc){if(!self._canPlaySrc(aSrc)){impl.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED};self.dispatchEvent("error");return}impl.src=aSrc;if(!isYouTubeReady()){addYouTubeCallback(function(){changeSrc(aSrc)});return}if(playerReady){if(mediaReady){destroyPlayer()}else{addMediaReadyCallback(function(){changeSrc(aSrc)});return}}parent.appendChild(elem);var playerVars=self._util.parseUri(aSrc).queryKey;delete playerVars.v;impl.autoplay=playerVars.autoplay==="1"||impl.autoplay;delete playerVars.autoplay;impl.loop=playerVars.loop==="1"||impl.loop;delete playerVars.loop;playerVars.rel=playerVars.rel||0;playerVars.modestbranding=playerVars.modestbranding||1;playerVars.iv_load_policy=playerVars.iv_load_policy||3;playerVars.disablekb=playerVars.disablekb||1;playerVars.showinfo=playerVars.showinfo||0;var domain=window.location.protocol==="file:"?"*":window.location.protocol+"//"+window.location.host;playerVars.origin=playerVars.origin||domain;playerVars.controls=playerVars.controls||impl.controls?2:0;impl.controls=playerVars.controls;playerVars.wmode=playerVars.wmode||"opaque";aSrc=regexYouTube.exec(aSrc)[1];var xhrURL="https://gdata.youtube.com/feeds/api/videos/"+aSrc+"?v=2&alt=jsonc&callback=?";Popcorn.getJSONP(xhrURL,function(resp){var warning="failed to retreive duration data, reason: ";if(resp.error){console.warn(warning+resp.error.message);return}else if(!resp.data){console.warn(warning+"no response data");return}impl.duration=resp.data.duration;self.dispatchEvent("durationchange");player=new YT.Player(elem,{width:"100%",height:"100%",wmode:playerVars.wmode,videoId:aSrc,playerVars:playerVars,events:{onReady:onPlayerReady,onError:onPlayerError,onStateChange:onPlayerStateChange}});impl.networkState=self.NETWORK_LOADING;self.dispatchEvent("loadstart");self.dispatchEvent("progress")})}function monitorCurrentTime(){var playerTime=player.getCurrentTime();if(!impl.seeking){if(ABS(impl.currentTime-playerTime)>CURRENT_TIME_MONITOR_MS){onSeeking();onSeeked()}impl.currentTime=playerTime}else if(ABS(playerTime-impl.currentTime)<1){onSeeked()}}function monitorBuffered(){var fraction=player.getVideoLoadedFraction();if(fraction&&lastLoadedFraction!==fraction){lastLoadedFraction=fraction;onProgress()}}function changeCurrentTime(aTime){if(aTime===impl.currentTime){return}impl.currentTime=aTime;if(!mediaReady){addMediaReadyCallback(function(){onSeeking();player.seekTo(aTime)});return}onSeeking();player.seekTo(aTime)}function onTimeUpdate(){self.dispatchEvent("timeupdate")}function onSeeking(){addYouTubeEvent("pause",catchRoguePauseEvent);removeYouTubeEvent("pause",onPause);impl.seeking=true;self.dispatchEvent("seeking")}function onSeeked(){impl.ended=false;impl.seeking=false;self.dispatchEvent("timeupdate");self.dispatchEvent("seeked");self.dispatchEvent("canplay");self.dispatchEvent("canplaythrough")}function onPlay(){if(impl.ended){changeCurrentTime(0);impl.ended=false}timeUpdateInterval=setInterval(onTimeUpdate,self._util.TIMEUPDATE_MS);impl.paused=false;if(playerPaused){playerPaused=false;if(impl.loop&&!loopedPlay||!impl.loop){loopedPlay=true;self.dispatchEvent("play")}self.dispatchEvent("playing")}}function onProgress(){self.dispatchEvent("progress")}self.play=function(){impl.paused=false;if(!mediaReady){addMediaReadyCallback(function(){self.play()});return}player.playVideo()};function onPause(){impl.paused=true;if(!playerPaused){playerPaused=true;clearInterval(timeUpdateInterval);self.dispatchEvent("pause")}}self.pause=function(){impl.paused=true;if(!mediaReady){addMediaReadyCallback(function(){self.pause()});return}catchRoguePauseEvent();player.pauseVideo()};function onEnded(){if(impl.loop){changeCurrentTime(0);self.play()}else{impl.ended=true;onPause();addYouTubeEvent("play",catchRoguePlayEvent);removeYouTubeEvent("play",onPlay);self.dispatchEvent("timeupdate");self.dispatchEvent("ended")}}function setMuted(aValue){impl.muted=aValue;if(!mediaReady){addMediaReadyCallback(function(){setMuted(impl.muted)});return}player[aValue?"mute":"unMute"]();self.dispatchEvent("volumechange")}function getMuted(){return impl.muted}Object.defineProperties(self,{src:{get:function(){return impl.src},set:function(aSrc){if(aSrc&&aSrc!==impl.src){changeSrc(aSrc)}}},autoplay:{get:function(){return impl.autoplay},set:function(aValue){impl.autoplay=self._util.isAttributeSet(aValue)}},loop:{get:function(){return impl.loop},set:function(aValue){impl.loop=self._util.isAttributeSet(aValue)}},width:{get:function(){return self.parentNode.offsetWidth}},height:{get:function(){return self.parentNode.offsetHeight}},currentTime:{get:function(){return impl.currentTime},set:function(aValue){changeCurrentTime(aValue)}},duration:{get:function(){return impl.duration}},ended:{get:function(){return impl.ended}},paused:{get:function(){return impl.paused}},seeking:{get:function(){return impl.seeking}},readyState:{get:function(){return impl.readyState}},networkState:{get:function(){return impl.networkState}},volume:{get:function(){return impl.volume},set:function(aValue){if(aValue<0||aValue>1){throw"Volume value must be between 0.0 and 1.0"}impl.volume=aValue;if(!mediaReady){addMediaReadyCallback(function(){self.volume=aValue});return}player.setVolume(impl.volume*100);self.dispatchEvent("volumechange")}},muted:{get:function(){return getMuted()},set:function(aValue){setMuted(self._util.isAttributeSet(aValue))}},error:{get:function(){return impl.error}},buffered:{get:function(){var timeRanges={start:function(index){if(index===0){return 0}throw"INDEX_SIZE_ERR: DOM Exception 1"},end:function(index){if(index===0){if(!impl.duration){return 0}return impl.duration*lastLoadedFraction}throw"INDEX_SIZE_ERR: DOM Exception 1"},length:1};return timeRanges},configurable:true}});self._canPlaySrc=Popcorn.HTMLYouTubeVideoElement._canPlaySrc;self.canPlayType=Popcorn.HTMLYouTubeVideoElement.canPlayType;return self}Popcorn.HTMLYouTubeVideoElement=function(id){return new HTMLYouTubeVideoElement(id)};Popcorn.HTMLYouTubeVideoElement._canPlaySrc=function(url){return/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu).*(?:\/|v=)(.{11})/.test(url)?"probably":EMPTY_STRING};Popcorn.HTMLYouTubeVideoElement.canPlayType=function(type){return type==="video/x-youtube"?"probably":EMPTY_STRING}})(Popcorn,window,document);